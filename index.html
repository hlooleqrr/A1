<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù…Ù†ØµØ© FINO - ØªØ±Ø´ÙŠØ­ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="theme-color" content="#1e3a8a" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="FINO" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #1e3a8a;
      --secondary-color: #3b82f6;
      --accent-color: #f59e0b;
      --bg-gradient-1: #0f172a;
      --bg-gradient-2: #1e3a8a;
      --bg-gradient-3: #3b82f6;
      --card-bg: rgba(255, 255, 255, 0.95);
      --text-primary: #111827;
      --text-secondary: #6b7280;
    }
    
    /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
    .dark-mode {
      --primary-color: #60a5fa;
      --secondary-color: #3b82f6;
      --bg-gradient-1: #030712;
      --bg-gradient-2: #0f172a;
      --bg-gradient-3: #1e3a8a;
      --card-bg: rgba(30, 41, 59, 0.95);
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'Tajawal', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 25%, var(--bg-gradient-3) 50%, var(--bg-gradient-2) 75%, var(--bg-gradient-1) 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      min-height: 100vh;
      text-align: center;
      font-size: 18px;
      direction: rtl;
      color: var(--text-primary);
      overflow-x: hidden;
    }

    /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Splash Screen */
    #splashScreen {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0f172a 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      transition: opacity 0.8s ease, visibility 0.8s ease;
    }
    #splashScreen.hidden {
      opacity: 0;
      visibility: hidden;
    }
    .splash-logo {
      font-size: 60px;
      font-weight: 900;
      color: #fff;
      text-shadow: 0 0 30px rgba(59, 130, 246, 0.8), 0 0 60px rgba(59, 130, 246, 0.5);
      animation: logoGlow 2s ease-in-out infinite, logoScale 1s ease-out;
    }
    .splash-tagline {
      color: #94a3b8;
      font-size: 16px;
      margin-top: 10px;
      animation: fadeInUp 1s ease-out 0.5s both;
    }
    .splash-loader {
      width: 200px;
      height: 4px;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      margin-top: 30px;
      overflow: hidden;
    }
    .splash-loader-bar {
      width: 0%;
      height: 100%;
      background: linear-gradient(90deg, #f59e0b, #fbbf24);
      border-radius: 10px;
      animation: loadProgress 2s ease-out forwards;
    }
    @keyframes loadProgress {
      0% { width: 0%; }
      100% { width: 100%; }
    }
    @keyframes logoGlow {
      0%, 100% { text-shadow: 0 0 30px rgba(59, 130, 246, 0.8), 0 0 60px rgba(59, 130, 246, 0.5); }
      50% { text-shadow: 0 0 50px rgba(245, 158, 11, 0.8), 0 0 80px rgba(245, 158, 11, 0.5); }
    }
    @keyframes logoScale {
      0% { transform: scale(0.5); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø®Ù„ÙÙŠØ© */
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
    #particles {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }
    .particle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: rgba(255,255,255,0.3);
      border-radius: 50%;
      animation: floatParticle 15s infinite ease-in-out;
    }
    @keyframes floatParticle {
      0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
    }

    /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
    header {
      background: transparent;
      color: #fff;
      padding: 20px 15px;
      position: relative;
      z-index: 10;
    }
    header h1 {
      font-size: 28px;
      font-weight: 900;
      letter-spacing: 0.05em;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    header p {
      font-size: 14px;
      opacity: 0.9;
      margin-top: 5px;
    }

    /* Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª */
    #timeGreeting {
      font-size: 16px;
      color: #fbbf24;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .time-icon {
      font-size: 24px;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .page-container {
      max-width: 500px;
      margin: 0 auto;
      padding: 0 15px 100px;
      position: relative;
      z-index: 10;
    }

    /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
    .card {
      background: var(--card-bg);
      border-radius: 24px;
      padding: 25px 20px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
      margin-bottom: 16px;
      text-align: center;
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transform: translateY(0);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 35px 70px rgba(0, 0, 0, 0.3);
    }

    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    button, .btn {
      border-radius: 999px;
      border: none;
      padding: 16px 28px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }
    
    /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ÙˆØ¬Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± */
    button::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
      transform: scale(0);
      opacity: 0;
      transition: transform 0.5s, opacity 0.5s;
    }
    button:active::after {
      transform: scale(2);
      opacity: 1;
      transition: 0s;
    }

    button.primary, .btn.primary {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: #ffffff;
      box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4);
    }
    button.primary:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 15px 40px rgba(245, 158, 11, 0.5);
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
    }
    button.primary:active {
      transform: translateY(0) scale(0.98);
    }

    button.secondary, .btn.secondary {
      background: rgba(224, 242, 254, 0.9);
      color: #1d4ed8;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    button.secondary:hover {
      background: #dbeafe;
      transform: translateY(-2px);
    }

    button.small {
      padding: 12px 20px;
      font-size: 16px;
    }

    button.danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: #fff;
      box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
    }

    /* Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø¨Ø© */
    .reset-btn {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: 1px dashed #ef4444;
      padding: 8px 16px;
      font-size: 14px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .reset-btn:hover {
      background: #ef4444;
      color: #fff;
    }

    /* Ø§Ù„Ø­Ù‚ÙˆÙ„ */
    input, select, textarea {
      width: 100%;
      padding: 14px 16px;
      margin: 10px 0;
      font-size: 17px;
      border-radius: 14px;
      border: 2px solid #e5e7eb;
      text-align: right;
      background: #fff;
      color: var(--text-primary);
      transition: all 0.3s ease;
      font-family: inherit;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.15);
    }

    label {
      display: block;
      text-align: right;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 5px;
      color: var(--text-primary);
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ */
    .fade-in {
      animation: fadeInMove 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
    @keyframes fadeInMove {
      from { opacity: 0; transform: translateY(30px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    .fade-out {
      animation: fadeOutMove 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
    @keyframes fadeOutMove {
      to { opacity: 0; transform: translateY(-20px) scale(0.95); }
    }
    .slide-in-right {
      animation: slideInRight 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(50px); }
      to { opacity: 1; transform: translateX(0); }
    }

    /* Ø§Ù„ØµÙØ­Ø§Øª */
    .page { display: none; }
    .page.active { display: block; }

    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
    .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      margin: 15px 0;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #f59e0b, #fbbf24);
      border-radius: 10px;
      transition: width 0.5s ease;
    }
    .progress-text {
      font-size: 13px;
      color: var(--text-secondary);
      text-align: right;
      margin-bottom: 5px;
    }

    /* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
    .welcome-title {
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 10px;
      color: var(--text-primary);
    }
    .welcome-sub {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 20px;
      line-height: 1.6;
    }

    /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¨Ù†Ùƒ */
    .bank-card {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      border-radius: 18px;
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
      border: 2px solid #bfdbfe;
      margin: 12px 0;
      text-align: right;
      transition: all 0.3s ease;
    }
    .bank-card:hover {
      transform: scale(1.02);
      box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
    }
    .bank-logo {
      width: 55px;
      height: 55px;
      border-radius: 16px;
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      flex-shrink: 0;
      border: 2px solid #e5e7eb;
      font-size: 28px;
    }
    .bank-text-main {
      font-size: 17px;
      font-weight: 700;
      color: #0f172a;
    }
    .bank-text-sub {
      font-size: 13px;
      color: #4b5563;
      line-height: 1.5;
    }

    /* Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .result-main-block {
      background: linear-gradient(135deg, #e0f2fe 0%, #fff 60%);
      border-radius: 20px;
      padding: 20px;
      margin: 15px 0;
      text-align: right;
      border: 2px solid #bfdbfe;
    }
    .result-main-title {
      font-size: 14px;
      color: #1d4ed8;
      font-weight: 800;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 5px;
    }
    .result-amount-main {
      font-size: 36px;
      font-weight: 900;
      color: #1e40af;
      margin: 5px 0;
      line-height: 1.2;
    }
    .result-amount-words {
      font-size: 14px;
      color: #3b82f6;
      font-weight: 600;
    }

    /* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© */
    .result-details {
      background: #f8fafc;
      border-radius: 16px;
      padding: 15px;
      margin: 10px 0;
      border: 1px solid #e5e7eb;
    }
    .result-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px dashed #e5e7eb;
      font-size: 15px;
    }
    .result-row:last-child { border-bottom: none; }
    .result-row .label { color: var(--text-secondary); }
    .result-row .value { font-weight: 700; color: var(--text-primary); }

    /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ */
    .retirement-box {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border-radius: 16px;
      padding: 15px;
      margin: 15px 0;
      border: 2px solid #f59e0b;
      text-align: right;
    }
    .retirement-title {
      font-size: 14px;
      font-weight: 800;
      color: #92400e;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }
    .retirement-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      font-size: 14px;
      color: #78350f;
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
    .action-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
    }
    .action-btn {
      flex: 1;
      min-width: 120px;
      padding: 12px 15px;
      border-radius: 14px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    .action-btn.whatsapp {
      background: #25d366;
      color: #fff;
    }
    .action-btn.save {
      background: #3b82f6;
      color: #fff;
    }
    .action-btn.contract {
      background: #8b5cf6;
      color: #fff;
    }

    /* Ø§Ù„ÙÙˆØªØ± */
    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(10px);
      padding: 12px 15px;
      z-index: 100;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    .footer-inner {
      max-width: 500px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: #94a3b8;
      font-size: 12px;
    }
    .hijri-chip {
      background: rgba(59, 130, 246, 0.2);
      color: #60a5fa;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
    }

    /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø®ÙÙŠØ© */
    #miniAdminTools {
      position: fixed;
      bottom: 60px;
      left: 15px;
      width: 8px;
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      cursor: pointer;
      z-index: 101;
      transition: all 0.3s ease;
    }
    #miniAdminTools:hover {
      width: 40px;
      height: 40px;
      background: rgba(245, 158, 11, 0.8);
    }
    #miniAdminTools:hover::after {
      content: 'âš™ï¸';
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù‚Ù‚ */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(5px);
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .modal-overlay.active { display: flex; }
    .modal-content {
      background: #fff;
      border-radius: 24px;
      padding: 30px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      animation: modalIn 0.3s ease;
    }
    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ */
    .admin-hub {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-top: 20px;
    }
    .admin-hub-btn {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border: 2px solid #e5e7eb;
      border-radius: 16px;
      padding: 20px 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }
    .admin-hub-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      border-color: var(--accent-color);
    }
    .admin-hub-btn .icon {
      font-size: 28px;
      margin-bottom: 8px;
    }
    .admin-hub-btn .text {
      font-size: 13px;
      font-weight: 700;
      color: var(--text-primary);
    }

    /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 13px;
    }
    .admin-table th, .admin-table td {
      border: 1px solid #e5e7eb;
      padding: 10px 8px;
      text-align: center;
    }
    .admin-table th {
      background: #f3f4f6;
      font-weight: 700;
    }
    .admin-table tr:hover { background: #f9fafb; }

    /* Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ */
    .toggle-switch {
      position: relative;
      width: 50px;
      height: 26px;
      background: #e5e7eb;
      border-radius: 999px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .toggle-switch.active { background: #22c55e; }
    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 20px;
      height: 20px;
      background: #fff;
      border-radius: 50%;
      transition: transform 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .toggle-switch.active::after { transform: translateX(24px); }

    /* Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø§Ù„Ù†Ø¬ÙˆÙ… */
    .star-rating {
      display: flex;
      gap: 5px;
      justify-content: center;
      direction: ltr;
    }
    .star-rating .star {
      font-size: 30px;
      color: #e5e7eb;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .star-rating .star:hover,
    .star-rating .star.active { color: #f59e0b; transform: scale(1.1); }

    /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
    .toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: #1e293b;
      color: #fff;
      padding: 12px 24px;
      border-radius: 12px;
      font-size: 14px;
      z-index: 10000;
      opacity: 0;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    .toast.success { background: #22c55e; }
    .toast.error { background: #ef4444; }

    /* Responsive */
    @media (max-width: 480px) {
      .result-amount-main { font-size: 28px; }
      .admin-hub { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
<div id="splashScreen">
  <div class="splash-logo">FINO</div>
  <div class="splash-tagline">Ù…Ù†ØµØ© ØªØ±Ø´ÙŠØ­ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ</div>
  <div class="splash-loader">
    <div class="splash-loader-bar"></div>
  </div>
</div>

<!-- Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© -->
<div id="particles"></div>

<!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
<header>
  <div id="timeGreeting"></div>
  <h1>Ù…Ù†ØµØ© FINO</h1>
  <p>Ù†Ø­Ø³Ø¨ Ù„Ùƒ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆÙ†Ø±Ø´Ø­ Ù„Ùƒ Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù†Ø³Ø¨</p>
</header>

<div class="page-container">

  <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <div id="landingPage" class="page active">
    <div class="card fade-in">
      <div class="welcome-title" id="welcomeTitle">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ FINO</div>
      <div class="welcome-sub" id="welcomeSub">Ù…Ù†ØµØ© Ø°ÙƒÙŠØ© ØªØ­Ø³Ø¨ Ù„Ùƒ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØªÙØ±Ø´Ù‘Ø­ Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù†Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø±Ø§ØªØ¨Ùƒ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„ØªØ²Ø§Ù…Ø§ØªÙƒ Ø®Ù„Ø§Ù„ Ø«ÙˆØ§Ù†Ù</div>
      
      <div id="statsCounter" style="margin: 20px 0; display: none;">
        <div style="font-size: 14px; color: var(--text-secondary);">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†</div>
        <div style="font-size: 32px; font-weight: 900; color: var(--accent-color);" id="clientsCount">0</div>
      </div>
      
      <button class="primary" id="mainButton" onclick="startCalculator()">
        <span>ğŸš€</span> Ø§Ø¨Ø¯Ø£ Ø¨Ø£Ø³Ù… Ø§Ù„Ù„Ù‡
      </button>
      
      <div id="earlySettlementBtn" style="margin-top: 15px; display: none;">
        <button class="secondary small" onclick="showPage('earlySettlement')">
          <span>ğŸ’°</span> Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±
        </button>
      </div>
    </div>
    
    <!-- Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª -->
    <div id="ratingsSection" class="card fade-in" style="display: none;">
      <div style="font-size: 16px; font-weight: 700; margin-bottom: 15px;">â­ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
      <div id="ratingsList"></div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
  <div id="questionPage" class="page">
    <div class="card fade-in">
      <div class="progress-text">
        <span id="progressText">Ø§Ù„Ø³Ø¤Ø§Ù„ 1 Ù…Ù† 10</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 10%"></div>
      </div>
      
      <div id="question"></div>
      
      <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
        <button class="primary" id="nextButton" onclick="nextQuestion()">Ø§Ù„ØªØ§Ù„ÙŠ â†</button>
        <button class="reset-btn" id="resetBtn" onclick="resetCalculator()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø¨Ø©</button>
      </div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
  <div id="resultPage" class="page">
    <div class="card fade-in" id="resultCard">
      <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    </div>
    
    <!-- Ø§Ù„ØªÙ‚ÙŠÙŠÙ… -->
    <div class="card fade-in" id="ratingCard" style="display: none;">
      <div style="font-size: 16px; font-weight: 700; margin-bottom: 10px;">ÙƒÙŠÙ ÙƒØ§Ù†Øª ØªØ¬Ø±Ø¨ØªÙƒØŸ</div>
      <div class="star-rating" id="starRating">
        <span class="star" data-rating="1">â˜…</span>
        <span class="star" data-rating="2">â˜…</span>
        <span class="star" data-rating="3">â˜…</span>
        <span class="star" data-rating="4">â˜…</span>
        <span class="star" data-rating="5">â˜…</span>
      </div>
      <textarea id="ratingComment" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="margin-top: 10px; height: 60px;"></textarea>
      <button class="secondary small" onclick="submitRating()" style="margin-top: 10px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
    </div>
    
    <div class="action-buttons">
      <button class="action-btn whatsapp" onclick="shareWhatsApp()">
        <span>ğŸ“±</span> ÙˆØ§ØªØ³Ø§Ø¨
      </button>
      <button class="action-btn save" onclick="saveAsImage()">
        <span>ğŸ“¸</span> Ø­ÙØ¸ ØµÙˆØ±Ø©
      </button>
      <button class="action-btn" style="background: #6b7280; color: #fff;" onclick="resetCalculator()">
        <span>ğŸ”„</span> Ø­Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
      </button>
    </div>
    
    <div id="contractBtn" style="margin-top: 15px; display: none;">
      <button class="primary" onclick="openContract()" style="width: 100%;">
        <span>ğŸ“</span> <span id="contractBtnText">Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯</span>
      </button>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ± -->
  <div id="earlySettlementPage" class="page">
    <div class="card fade-in">
      <div style="font-size: 20px; font-weight: 800; margin-bottom: 15px;">ğŸ’° Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±</div>
      <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;">
        Ø§Ø­Ø³Ø¨ Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ± Ø­Ø³Ø¨ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ (Ø³Ø§Ù…Ø§)
      </p>
      
      <label>Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„</label>
      <select id="esFinanceType">
        <option value="">Ø§Ø®ØªØ±...</option>
        <option value="personal">ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ / Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ</option>
        <option value="mortgage">ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ</option>
        <option value="car">ØªÙ…ÙˆÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª (ØªØ£Ø¬ÙŠØ±ÙŠ)</option>
      </select>
      
      <label>Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠ (Ø±ÙŠØ§Ù„)</label>
      <input type="number" id="esOriginalAmount" placeholder="Ù…Ø«Ø§Ù„: 100000">
      
      <label>Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ„ÙŠØ© (Ø´Ù‡Ø±)</label>
      <input type="number" id="esTotalMonths" placeholder="Ù…Ø«Ø§Ù„: 60">
      
      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…Ø³Ø¯Ø¯Ø©</label>
      <input type="number" id="esPaidMonths" placeholder="Ù…Ø«Ø§Ù„: 24">
      
      <label>Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ© (%)</label>
      <input type="number" id="esRate" step="0.01" placeholder="Ù…Ø«Ø§Ù„: 5.5">
      
      <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button class="primary" onclick="calculateEarlySettlement()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±</button>
        <button class="secondary" onclick="showPage('landing')">Ø±Ø¬ÙˆØ¹</button>
      </div>
      
      <div id="esResult" style="display: none; margin-top: 20px;"></div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ -->
  <div id="comingSoonPage" class="page">
    <div class="card fade-in">
      <div style="font-size: 50px; margin-bottom: 15px;">ğŸš§</div>
      <div style="font-size: 20px; font-weight: 800;" id="comingSoonTitle">Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>
      <p style="font-size: 14px; color: var(--text-secondary); margin: 15px 0;" id="comingSoonText">
        Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹
      </p>
      <button class="secondary" onclick="resetCalculator()">Ø§Ø®ØªÙŠØ§Ø± ØªÙ…ÙˆÙŠÙ„ Ø¢Ø®Ø±</button>
    </div>
  </div>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <div id="adminHubPage" class="page">
    <div class="card fade-in">
      <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
      <p style="font-size: 13px; color: var(--text-secondary);">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØµØ©</p>
      
      <div class="admin-hub">
        <div class="admin-hub-btn" onclick="showPage('adminBanks')">
          <div class="icon">ğŸ¦</div>
          <div class="text">Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ù†Ø³Ø¨</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminJobs')">
          <div class="icon">ğŸ’¼</div>
          <div class="text">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminProducts')">
          <div class="icon">ğŸ“¦</div>
          <div class="text">Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminResults')">
          <div class="icon">ğŸ“Š</div>
          <div class="text">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminAds')">
          <div class="icon">ğŸ“¢</div>
          <div class="text">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminOffers')">
          <div class="icon">ğŸ</div>
          <div class="text">Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ©</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminRatings')">
          <div class="icon">â­</div>
          <div class="text">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminSettings')">
          <div class="icon">ğŸ¨</div>
          <div class="text">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminFeatures')">
          <div class="icon">âœ¨</div>
          <div class="text">Ø§Ù„Ù…ÙŠØ²Ø§Øª</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminDocs')">
          <div class="icon">ğŸ“„</div>
          <div class="text">Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminSecurity')">
          <div class="icon">ğŸ”’</div>
          <div class="text">Ø§Ù„Ø£Ù…Ø§Ù†</div>
        </div>
        <div class="admin-hub-btn" onclick="showPage('adminTheme')">
          <div class="icon">ğŸ¨</div>
          <div class="text">Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø«ÙŠÙ…</div>
        </div>
      </div>
      
      <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
        <button class="danger small" onclick="togglePlatformLock()">
          <span id="lockIcon">ğŸ”“</span> <span id="lockText">Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©</span>
        </button>
        <button class="secondary small" onclick="backToLanding()">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      </div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ù†ÙˆÙƒ -->
  <div id="adminBanksPage" class="page">
    <div class="card fade-in">
      <div style="font-size: 18px; font-weight: 800; margin-bottom: 10px;">ğŸ¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ù†Ø³Ø¨</div>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: right;">
        <div>
          <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</label>
          <select id="adminBankName">
            <option value="">Ø§Ø®ØªØ±...</option>
            <option>Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ</option>
            <option>Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ</option>
            <option>Ø¨Ù†Ùƒ Ø§Ù„Ø±ÙŠØ§Ø¶</option>
            <option>Ø¨Ù†Ùƒ Ø³Ø§Ø¨</option>
            <option>Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„ÙˆØ·Ù†ÙŠ</option>
            <option>Ù…ØµØ±Ù Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡</option>
            <option>Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ</option>
            <option>Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</option>
            <option>Ø¨Ù†Ùƒ Ø§Ù„Ø¨Ù„Ø§Ø¯</option>
            <option>Ø¨Ù†Ùƒ Ø§Ù„Ø¬Ø²ÙŠØ±Ø©</option>
          </select>
        </div>
        <div>
          <label>Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„</label>
          <select id="adminFinanceType">
            <option value="personal">Ø´Ø®ØµÙŠ</option>
            <option value="mortgage">Ø¹Ù‚Ø§Ø±ÙŠ</option>
            <option value="car">Ø³ÙŠØ§Ø±Ø§Øª</option>
          </select>
        </div>
        <div>
          <label>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø±Ø§ØªØ¨</label>
          <input type="number" id="adminMinSalary" placeholder="4000">
        </div>
        <div>
          <label>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø±Ø§ØªØ¨</label>
          <input type="number" id="adminMaxSalary" placeholder="20000">
        </div>
        <div>
          <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ (%)</label>
          <input type="number" id="adminMargin" step="0.01" placeholder="5.5">
        </div>
        <div>
          <label>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø¹Ù…Ø±</label>
          <input type="number" id="adminMaxAge" placeholder="60">
        </div>
      </div>
      
      <div style="margin-top: 15px; display: flex; gap: 10px;">
        <button class="primary small" onclick="saveBankConfig()">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="secondary small" onclick="showPage('adminHub')">Ø±Ø¬ÙˆØ¹</button>
      </div>
      
      <div style="margin-top: 20px; overflow-x: auto;">
        <table class="admin-table" id="bankConfigsTable">
          <thead>
            <tr>
              <th>Ø§Ù„Ø¨Ù†Ùƒ</th>
              <th>Ø§Ù„Ù†ÙˆØ¹</th>
              <th>Ø§Ù„Ø±Ø§ØªØ¨</th>
              <th>Ø§Ù„Ù†Ø³Ø¨Ø©</th>
              <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© -->
  <div id="adminSettingsPage" class="page">
    <div class="card fade-in">
      <div style="font-size: 18px; font-weight: 800; margin-bottom: 15px;">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</div>
      
      <div style="text-align: right;">
        <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©)</label>
        <input type="text" id="settingWhatsapp" placeholder="966500000000">
        
        <label>Ø±Ø§Ø¨Ø· Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯</label>
        <input type="text" id="settingContractUrl" placeholder="https://...">
        
        <label>Ù†Øµ Ø²Ø± Ø§Ù„Ø¹Ù‚Ø¯</label>
        <input type="text" id="settingContractText" placeholder="Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯">
        
        <label>Ù†Øµ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ (Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)</label>
        <textarea id="settingMarketingText" style="height: 60px;" placeholder="Ù†Ù†Ø¬Ø² ØªÙ…ÙˆÙŠÙ„Ùƒ Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª..."></textarea>
        
        <label>Ø£Ù‚ØµÙ‰ Ø¹Ù…Ø± Ù„Ù„ØªÙ…ÙˆÙŠÙ„</label>
        <input type="number" id="settingMaxAge" placeholder="60">
        
        <label>Ø·Ø±ÙŠÙ‚Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±</label>
        <select id="settingAgeMethod">
          <option value="hijri">Ù‡Ø¬Ø±ÙŠ</option>
          <option value="gregorian">Ù…ÙŠÙ„Ø§Ø¯ÙŠ</option>
        </select>
      </div>
      
      <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button class="primary small" onclick="saveGeneralSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        <button class="secondary small" onclick="showPage('adminHub')">Ø±Ø¬ÙˆØ¹</button>
      </div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø§Ù„Ù…ÙŠØ²Ø§Øª -->
  <div id="adminFeaturesPage" class="page">
    <div class="card fade-in">
      <div style="font-size: 18px; font-weight: 800; margin-bottom: 15px;">âœ¨ ØªÙØ¹ÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙŠØ²Ø§Øª</div>
      
      <div style="text-align: right;">
        <div class="feature-toggle">
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Splash)</span>
            <div class="toggle-switch active" id="toggleSplash" onclick="toggleFeature('splash')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©</span>
            <div class="toggle-switch active" id="toggleParticles" onclick="toggleFeature('particles')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª</span>
            <div class="toggle-switch active" id="toggleTimeGreeting" onclick="toggleFeature('timeGreeting')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…</span>
            <div class="toggle-switch active" id="toggleProgress" onclick="toggleFeature('progress')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±</span>
            <div class="toggle-switch active" id="toggleEarlySettlement" onclick="toggleFeature('earlySettlement')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</span>
            <div class="toggle-switch active" id="toggleRatings" onclick="toggleFeature('ratings')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø²Ø± Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯</span>
            <div class="toggle-switch active" id="toggleContract" onclick="toggleFeature('contract')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</span>
            <div class="toggle-switch" id="toggleStats" onclick="toggleFeature('stats')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
            <span>Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
            <div class="toggle-switch" id="toggleDarkMode" onclick="toggleFeature('darkMode')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0;">
            <span>Ø§Ù„Ø£ØµÙˆØ§Øª</span>
            <div class="toggle-switch" id="toggleSounds" onclick="toggleFeature('sounds')"></div>
          </div>
        </div>
      </div>
      
      <div style="margin-top: 20px;">
        <button class="secondary small" onclick="showPage('adminHub')">Ø±Ø¬ÙˆØ¹</button>
      </div>
    </div>
  </div>

  <!-- ØµÙØ­Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø«ÙŠÙ… -->
  <div id="adminThemePage" class="page">
    <div class="card fade-in">
      <div style="font-size: 18px; font-weight: 800; margin-bottom: 15px;">ğŸ¨ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø«ÙŠÙ…</div>
      
      <div style="text-align: right;">
        <label>Ø§Ø®ØªØ± Ø§Ù„Ø«ÙŠÙ…</label>
        <select id="themeSelect" onchange="changeTheme(this.value)">
          <option value="blue">Ø£Ø²Ø±Ù‚ (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)</option>
          <option value="green">Ø£Ø®Ø¶Ø±</option>
          <option value="purple">Ø¨Ù†ÙØ³Ø¬ÙŠ</option>
          <option value="gold">Ø°Ù‡Ø¨ÙŠ</option>
          <option value="dark">Ø£Ø³ÙˆØ¯</option>
          <option value="custom">Ù…Ø®ØµØµ</option>
        </select>
        
        <div id="customColors" style="display: none; margin-top: 15px;">
          <label>Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</label>
          <input type="color" id="customPrimary" value="#1e3a8a">
          
          <label>Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</label>
          <input type="color" id="customSecondary" value="#3b82f6">
          
          <label>Ù„ÙˆÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø±</label>
          <input type="color" id="customAccent" value="#f59e0b">
        </div>
      </div>
      
      <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button class="primary small" onclick="saveTheme()">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="secondary small" onclick="showPage('adminHub')">Ø±Ø¬ÙˆØ¹</button>
      </div>
    </div>
  </div>

</div>

<!-- Ø§Ù„ÙÙˆØªØ± -->
<footer>
  <div class="footer-inner">
    <div>
      <span id="datetime"></span>
      <span class="hijri-chip">Ù‡Ø¬Ø±ÙŠ: <span id="datetimeHijri"></span></span>
    </div>
    <div style="font-size: 11px;">Â© FINO - Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø±</div>
  </div>
</footer>

<!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø®ÙÙŠØ© -->
<div id="miniAdminTools" onclick="openAdminAuth()"></div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù‚Ù‚ -->
<div class="modal-overlay" id="adminAuthModal">
  <div class="modal-content">
    <div style="font-size: 40px; margin-bottom: 15px;">ğŸ”</div>
    <div style="font-size: 18px; font-weight: 700; margin-bottom: 15px;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</div>
    <input type="password" id="adminPassword" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„">
    <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: center;">
      <button class="primary small" onclick="verifyAdmin()">Ø¯Ø®ÙˆÙ„</button>
      <button class="secondary small" onclick="closeAdminAuth()">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
<div class="toast" id="toast"></div>

<!-- Ù…ÙƒØªØ¨Ø© Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>


<script>
// ==================== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ====================
const ADMIN_CODE = '11qq11qQ@';

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØµØ© (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„)
let platformSettings = JSON.parse(localStorage.getItem('platformSettings')) || {
  whatsapp: '966500000000',
  contractUrl: '',
  contractText: 'Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯',
  marketingText: 'Ù†Ù†Ø¬Ø² ØªÙ…ÙˆÙŠÙ„Ùƒ Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§',
  maxAge: 60,
  ageMethod: 'hijri',
  isLocked: false,
  lockMessage: 'Ø§Ù„Ù…Ù†ØµØ© Ù…ØºÙ„Ù‚Ø© Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ù„ØµÙŠØ§Ù†Ø©'
};

// Ø§Ù„Ù…ÙŠØ²Ø§Øª (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙØ¹ÙŠÙ„/Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù)
let features = JSON.parse(localStorage.getItem('features')) || {
  splash: true,
  particles: true,
  timeGreeting: true,
  progress: true,
  earlySettlement: true,
  ratings: true,
  contract: true,
  stats: false,
  darkMode: false,
  sounds: false
};

// Ø§Ù„Ø«ÙŠÙ…
let themeSettings = JSON.parse(localStorage.getItem('themeSettings')) || {
  theme: 'blue',
  customPrimary: '#1e3a8a',
  customSecondary: '#3b82f6',
  customAccent: '#f59e0b'
};

// Ø§Ù„Ø¨Ù†ÙˆÙƒ
let banks = JSON.parse(localStorage.getItem('banks')) || [
  { name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', logo: 'ğŸ¦', active: true },
  { name: 'Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ', logo: 'ğŸ›ï¸', active: true },
  { name: 'Ø¨Ù†Ùƒ Ø§Ù„Ø±ÙŠØ§Ø¶', logo: 'ğŸ¦', active: true },
  { name: 'Ø¨Ù†Ùƒ Ø³Ø§Ø¨', logo: 'ğŸ¦', active: true },
  { name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„ÙˆØ·Ù†ÙŠ', logo: 'ğŸ¦', active: true },
  { name: 'Ù…ØµØ±Ù Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡', logo: 'ğŸ¦', active: true },
  { name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ', logo: 'ğŸ¦', active: true },
  { name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±', logo: 'ğŸ¦', active: true },
  { name: 'Ø¨Ù†Ùƒ Ø§Ù„Ø¨Ù„Ø§Ø¯', logo: 'ğŸ¦', active: true },
  { name: 'Ø¨Ù†Ùƒ Ø§Ù„Ø¬Ø²ÙŠØ±Ø©', logo: 'ğŸ¦', active: true }
];

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ù†Ø³Ø¨
let bankConfigs = JSON.parse(localStorage.getItem('bankConfigs')) || [];

// Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
let jobTypes = JSON.parse(localStorage.getItem('jobTypes')) || [
  { id: 'government', name: 'Ø­ÙƒÙˆÙ…ÙŠ', active: true },
  { id: 'military', name: 'Ø¹Ø³ÙƒØ±ÙŠ', active: true },
  { id: 'private', name: 'Ù‚Ø·Ø§Ø¹ Ø®Ø§Øµ', active: true },
  { id: 'retired', name: 'Ù…ØªÙ‚Ø§Ø¹Ø¯', active: true }
];

// Ø§Ù„Ø±ØªØ¨ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©
const militaryRanks = [
  'Ø¬Ù†Ø¯ÙŠ', 'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„', 'Ø¹Ø±ÙŠÙ', 'ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨', 'Ø±Ù‚ÙŠØ¨', 'Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„',
  'Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡', 'Ù…Ù„Ø§Ø²Ù…', 'Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„', 'Ù†Ù‚ÙŠØ¨', 'Ø±Ø§Ø¦Ø¯', 'Ù…Ù‚Ø¯Ù…',
  'Ø¹Ù‚ÙŠØ¯', 'Ø¹Ù…ÙŠØ¯', 'Ù„ÙˆØ§Ø¡', 'ÙØ±ÙŠÙ‚', 'ÙØ±ÙŠÙ‚ Ø£ÙˆÙ„'
];

// Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„
let financeProducts = JSON.parse(localStorage.getItem('financeProducts')) || [
  { id: 'personal', name: 'ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ', icon: 'ğŸ’³', active: true },
  { id: 'mortgage', name: 'ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ', icon: 'ğŸ ', active: true },
  { id: 'car', name: 'ØªÙ…ÙˆÙŠÙ„ ØªØ£Ø¬ÙŠØ±ÙŠ (Ø³ÙŠØ§Ø±Ø§Øª)', icon: 'ğŸš—', active: true }
];

// Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
let clientResults = JSON.parse(localStorage.getItem('clientResults')) || [];

// Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
let ratings = JSON.parse(localStorage.getItem('ratings')) || [];

// Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
let ads = JSON.parse(localStorage.getItem('ads')) || [];

// Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ©
let offers = JSON.parse(localStorage.getItem('offers')) || [];

// Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„
let loginAttempts = JSON.parse(localStorage.getItem('loginAttempts')) || [];

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
let clientData = {};
let currentQuestion = 0;
let totalQuestions = 10;

// Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
let questions = [];

// Ø§Ù„ØªØ±Ø­ÙŠØ¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
const timeGreetings = {
  morning: { text: 'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±', icon: 'ğŸŒ…', bg: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)' },
  afternoon: { text: 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ù†ÙˆØ±', icon: 'â˜€ï¸', bg: 'linear-gradient(135deg, #fed7aa 0%, #fdba74 100%)' },
  evening: { text: 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±', icon: 'ğŸŒ†', bg: 'linear-gradient(135deg, #c7d2fe 0%, #a5b4fc 100%)' },
  night: { text: 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø§Ù„Ù„ÙŠÙ„', icon: 'ğŸŒ™', bg: 'linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%)' }
};

// Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ© Ø§Ù„Ù…ØªÙ†ÙˆØ¹Ø©
const marketingMessages = [
  'Ø­ÙŠØ§Ùƒ Ø§Ù„Ù„Ù‡! ğŸŒŸ Ù†Ø­Ø³Ø¨ Ù„Ùƒ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø¨Ø¯Ù‚Ø©',
  'Ù‡Ù„Ø§ ÙˆØ§Ù„Ù„Ù‡! ğŸ’° Ø®Ù„Ù†Ø§ Ù†Ø³Ø§Ø¹Ø¯Ùƒ ØªØ­Ù‚Ù‚ Ø­Ù„Ù…Ùƒ',
  'Ø§Ù„Ù„Ù‡ ÙŠØ­ÙŠÙŠÙƒ! ğŸ  ØªÙ…ÙˆÙŠÙ„Ùƒ Ø¹Ù„Ù‰ ÙƒÙŠÙÙƒ',
  'Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹! âœ¨ Ù†Ø±Ø´Ø­ Ù„Ùƒ Ø§Ù„Ø£Ù†Ø³Ø¨',
  'Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ! ğŸ¯ Ø¯Ù‚Ø© ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ³Ø±Ø¹Ø© ÙÙŠ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²',
  'ÙŠØ§ Ù‡Ù„Ø§! ğŸ’³ ØªÙ…ÙˆÙŠÙ„Ùƒ Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ',
  'Ù†ÙˆØ±Øª Ø§Ù„Ù…Ù†ØµØ©! ğŸŒŸ Ø®Ø¯Ù…ØªÙƒ Ø´Ø±Ù Ù„Ù†Ø§',
  'Ø§Ù„Ù„Ù‡ ÙŠØ³Ø¹Ø¯Ùƒ! ğŸ¦ Ù†Ø®ØªØ§Ø± Ù„Ùƒ Ø§Ù„Ø£ÙØ¶Ù„',
  'Ø­ÙŠØ§Ùƒ! ğŸ’ ØªÙ…ÙˆÙŠÙ„ ÙŠÙ†Ø§Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ùƒ',
  'Ø£Ù‡Ù„ÙŠÙ†! ğŸš€ Ø³Ø±Ø¹Ø© ÙˆØ«Ù‚Ø© ÙÙŠ Ø®Ø¯Ù…ØªÙƒ'
];

// Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø©
const resultMessages = [
  'Ø§Ù„Ù„Ù‡ ÙŠÙˆÙÙ‚Ùƒ! ğŸ¤',
  'Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø§Ù„ØªÙˆÙÙŠÙ‚! ğŸŒŸ',
  'Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡! ğŸ’ª',
  'Ø¹Ù‚Ø¨Ø§Ù„ Ù…Ø§ ØªØ­Ù‚Ù‚ ÙƒÙ„ Ø£Ø­Ù„Ø§Ù…Ùƒ! âœ¨',
  'Ø§Ù„Ù„Ù‡ ÙŠØ³Ù‡Ù„ Ø£Ù…ÙˆØ±Ùƒ! ğŸ™',
  'Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø­ÙŠØ§Ø© Ø³Ø¹ÙŠØ¯Ø©! ğŸ ',
  'Ø¨Ø§Ù„Ù†Ø¬Ø§Ø­ ÙˆØ§Ù„ØªÙˆÙÙŠÙ‚! ğŸ¯',
  'Ø§Ù„Ù„Ù‡ ÙŠÙƒØªØ¨ Ù„Ùƒ Ø§Ù„Ø®ÙŠØ±! ğŸ’š',
  'Ø¹Ø³Ø§Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ©! ğŸ’ª',
  'Ù…ÙˆÙÙ‚ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡! ğŸŒŸ'
];

// ==================== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ù†ØµØ©
function initPlatform() {
  // Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
  if (features.splash) {
    setTimeout(() => {
      document.getElementById('splashScreen').classList.add('hidden');
    }, 2500);
  } else {
    document.getElementById('splashScreen').style.display = 'none';
  }
  
  // Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
  if (features.particles) {
    createParticles();
  }
  
  // Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
  if (features.timeGreeting) {
    updateTimeGreeting();
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ®
  updateDateTime();
  setInterval(updateDateTime, 60000);
  
  // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø«ÙŠÙ…
  applyTheme();
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Øª
  updateFeaturesUI();
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©
  if (platformSettings.isLocked) {
    showLockScreen();
  }
  
  // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
  if (features.darkMode) {
    checkDarkMode();
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
  if (features.stats) {
    document.getElementById('statsCounter').style.display = 'block';
    animateCounter('clientsCount', clientResults.length);
  }
  
  // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
  if (features.ratings) {
    displayRatings();
  }
  
  // Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±
  if (features.earlySettlement) {
    document.getElementById('earlySettlementBtn').style.display = 'block';
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
function createParticles() {
  const container = document.getElementById('particles');
  for (let i = 0; i < 30; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.animationDelay = Math.random() * 15 + 's';
    particle.style.animationDuration = (15 + Math.random() * 10) + 's';
    particle.style.width = (4 + Math.random() * 4) + 'px';
    particle.style.height = particle.style.width;
    container.appendChild(particle);
  }
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
function updateTimeGreeting() {
  const hour = new Date().getHours();
  let greeting;
  
  if (hour >= 5 && hour < 12) {
    greeting = timeGreetings.morning;
  } else if (hour >= 12 && hour < 17) {
    greeting = timeGreetings.afternoon;
  } else if (hour >= 17 && hour < 21) {
    greeting = timeGreetings.evening;
  } else {
    greeting = timeGreetings.night;
  }
  
  document.getElementById('timeGreeting').innerHTML = `
    <span class="time-icon">${greeting.icon}</span>
    <span>${greeting.text}</span>
  `;
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
function updateDateTime() {
  const now = new Date();
  const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  document.getElementById('datetime').textContent = now.toLocaleDateString('ar-SA', options);
  
  // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ
  const hijriOptions = { calendar: 'islamic-umalqura', day: 'numeric', month: 'long', year: 'numeric' };
  document.getElementById('datetimeHijri').textContent = now.toLocaleDateString('ar-SA-u-ca-islamic-umalqura', hijriOptions);
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
function checkDarkMode() {
  const hour = new Date().getHours();
  if (hour >= 19 || hour < 6) {
    document.body.classList.add('dark-mode');
  } else {
    document.body.classList.remove('dark-mode');
  }
}

// Ø¹Ø±Ø¶ ØµÙØ­Ø©
function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  const page = document.getElementById(pageId + 'Page');
  if (page) {
    page.classList.add('active');
    page.querySelector('.card')?.classList.add('fade-in');
  }
}

// Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
function backToLanding() {
  showPage('landing');
}

// Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
function showToast(message, type = 'info') {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.className = 'toast show ' + type;
  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
}

// ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¹Ø¯Ø§Ø¯
function animateCounter(elementId, target) {
  const element = document.getElementById(elementId);
  let current = 0;
  const increment = Math.ceil(target / 50);
  const timer = setInterval(() => {
    current += increment;
    if (current >= target) {
      current = target;
      clearInterval(timer);
    }
    element.textContent = current.toLocaleString('ar-SA');
  }, 30);
}

// ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ù‚Ù… Ù„Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
function numberToArabicWords(num) {
  if (num === 0) return 'ØµÙØ±';
  
  const ones = ['', 'ÙˆØ§Ø­Ø¯', 'Ø§Ø«Ù†Ø§Ù†', 'Ø«Ù„Ø§Ø«Ø©', 'Ø£Ø±Ø¨Ø¹Ø©', 'Ø®Ù…Ø³Ø©', 'Ø³ØªØ©', 'Ø³Ø¨Ø¹Ø©', 'Ø«Ù…Ø§Ù†ÙŠØ©', 'ØªØ³Ø¹Ø©'];
  const tens = ['', 'Ø¹Ø´Ø±Ø©', 'Ø¹Ø´Ø±ÙˆÙ†', 'Ø«Ù„Ø§Ø«ÙˆÙ†', 'Ø£Ø±Ø¨Ø¹ÙˆÙ†', 'Ø®Ù…Ø³ÙˆÙ†', 'Ø³ØªÙˆÙ†', 'Ø³Ø¨Ø¹ÙˆÙ†', 'Ø«Ù…Ø§Ù†ÙˆÙ†', 'ØªØ³Ø¹ÙˆÙ†'];
  const teens = ['Ø¹Ø´Ø±Ø©', 'Ø£Ø­Ø¯ Ø¹Ø´Ø±', 'Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±', 'Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±', 'Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±', 'Ø®Ù…Ø³Ø© Ø¹Ø´Ø±', 'Ø³ØªØ© Ø¹Ø´Ø±', 'Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±', 'Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±', 'ØªØ³Ø¹Ø© Ø¹Ø´Ø±'];
  
  num = Math.floor(num);
  
  if (num >= 1000000) {
    const millions = Math.floor(num / 1000000);
    const remainder = num % 1000000;
    let result = millions === 1 ? 'Ù…Ù„ÙŠÙˆÙ†' : millions === 2 ? 'Ù…Ù„ÙŠÙˆÙ†Ø§Ù†' : millions + ' Ù…Ù„Ø§ÙŠÙŠÙ†';
    if (remainder > 0) result += ' Ùˆ' + numberToArabicWords(remainder);
    return result;
  }
  
  if (num >= 1000) {
    const thousands = Math.floor(num / 1000);
    const remainder = num % 1000;
    let result = thousands === 1 ? 'Ø£Ù„Ù' : thousands === 2 ? 'Ø£Ù„ÙØ§Ù†' : thousands + ' Ø¢Ù„Ø§Ù';
    if (remainder > 0) result += ' Ùˆ' + numberToArabicWords(remainder);
    return result;
  }
  
  if (num >= 100) {
    const hundreds = Math.floor(num / 100);
    const remainder = num % 100;
    const hundredWords = ['', 'Ù…Ø§Ø¦Ø©', 'Ù…Ø§Ø¦ØªØ§Ù†', 'Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©', 'Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©', 'Ø®Ù…Ø³Ù…Ø§Ø¦Ø©', 'Ø³ØªÙ…Ø§Ø¦Ø©', 'Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©', 'Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©', 'ØªØ³Ø¹Ù…Ø§Ø¦Ø©'];
    let result = hundredWords[hundreds];
    if (remainder > 0) result += ' Ùˆ' + numberToArabicWords(remainder);
    return result;
  }
  
  if (num >= 20) {
    const ten = Math.floor(num / 10);
    const one = num % 10;
    if (one === 0) return tens[ten];
    return ones[one] + ' Ùˆ' + tens[ten];
  }
  
  if (num >= 10) {
    return teens[num - 10];
  }
  
  return ones[num];
}

</script>

<script>
// ==================== Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø­Ø§Ø³Ø¨Ø© ====================

// Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©
function startCalculator() {
  if (platformSettings.isLocked) {
    showToast('Ø§Ù„Ù…Ù†ØµØ© Ù…ØºÙ„Ù‚Ø© Ù…Ø¤Ù‚ØªØ§Ù‹', 'error');
    return;
  }
  
  clientData = {};
  currentQuestion = 0;
  buildQuestions();
  showPage('question');
  displayQuestion();
}

// Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
function buildQuestions() {
  questions = [
    {
      id: 'name',
      title: 'ØªØ¹Ø±ÙÙ†Ø§ Ø¨Ø£Ø³Ù…Ùƒ ğŸ‘‹',
      type: 'text',
      placeholder: 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ…',
      required: true
    },
    {
      id: 'birthDate',
      title: 'ØªØ§Ø±ÙŠØ® Ù…ÙŠÙ„Ø§Ø¯Ùƒ (Ù‡Ø¬Ø±ÙŠ) ğŸ“…',
      type: 'date-hijri',
      required: true
    },
    {
      id: 'jobType',
      title: 'Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ© ğŸ’¼',
      type: 'select',
      options: jobTypes.filter(j => j.active).map(j => ({ value: j.id, label: j.name })),
      required: true
    },
    {
      id: 'militaryRank',
      title: 'Ø§Ø°ÙƒØ± Ø§Ù„Ø±ØªØ¨Ø© Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ© ğŸ–ï¸',
      type: 'select',
      options: militaryRanks.map(r => ({ value: r, label: r })),
      condition: () => clientData.jobType === 'military',
      required: true
    },
    {
      id: 'financeType',
      title: 'Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ğŸ’°',
      type: 'select',
      options: financeProducts.filter(p => p.active).map(p => ({ value: p.id, label: p.icon + ' ' + p.name })),
      required: true
    },
    {
      id: 'currentBank',
      title: 'Ø±Ø§ØªØ¨Ùƒ Ø­Ø§Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø£ÙŠ Ø¨Ù†ÙƒØŸ ğŸ¦',
      type: 'select',
      options: [{ value: 'none', label: 'ØºÙŠØ± Ù…Ø­ÙˆÙ„' }, ...banks.filter(b => b.active).map(b => ({ value: b.name, label: b.logo + ' ' + b.name }))],
      required: true
    },
    {
      id: 'salary',
      title: 'ÙƒÙ… Ø±Ø§ØªØ¨Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ ğŸ’µ',
      type: 'number',
      placeholder: 'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØµØ§ÙÙŠ Ø¨Ø§Ù„Ø±ÙŠØ§Ù„',
      min: 3000,
      required: true
    },
    {
      id: 'extendedFinance',
      title: 'ØªØ¨ÙŠ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙŠÙ…ØªØ¯ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ø¹Ù…Ø± 60ØŸ â°',
      type: 'select',
      options: [{ value: 'yes', label: 'Ù†Ø¹Ù…' }, { value: 'no', label: 'Ù„Ø§' }],
      condition: () => clientData.jobType === 'military' || clientData.jobType === 'government',
      required: true
    },
    {
      id: 'hireDate',
      title: 'ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ† (Ù‡Ø¬Ø±ÙŠ) ğŸ“‹',
      type: 'date-hijri',
      condition: () => clientData.extendedFinance === 'yes',
      required: true
    },
    {
      id: 'duration',
      title: 'Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ğŸ“†',
      type: 'select',
      options: [
        { value: '12', label: '12 Ø´Ù‡Ø± (Ø³Ù†Ø©)' },
        { value: '24', label: '24 Ø´Ù‡Ø± (Ø³Ù†ØªÙŠÙ†)' },
        { value: '36', label: '36 Ø´Ù‡Ø± (3 Ø³Ù†ÙˆØ§Øª)' },
        { value: '48', label: '48 Ø´Ù‡Ø± (4 Ø³Ù†ÙˆØ§Øª)' },
        { value: '60', label: '60 Ø´Ù‡Ø± (5 Ø³Ù†ÙˆØ§Øª)' },
        { value: '72', label: '72 Ø´Ù‡Ø± (6 Ø³Ù†ÙˆØ§Øª)' },
        { value: '84', label: '84 Ø´Ù‡Ø± (7 Ø³Ù†ÙˆØ§Øª)' }
      ],
      required: true
    },
    {
      id: 'preferredBank',
      title: 'ØªÙØ¶Ù„ Ø¨Ù†Ùƒ Ù…Ø¹ÙŠÙ†ØŸ ğŸ¦',
      type: 'select',
      options: [{ value: 'auto', label: 'ğŸ¯ Ø±Ø´Ø­ Ù„ÙŠ Ø¨Ù†Ùƒ Ù…Ù†Ø§Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹' }, ...banks.filter(b => b.active).map(b => ({ value: b.name, label: b.logo + ' ' + b.name }))],
      required: true
    },
    {
      id: 'hasObligations',
      title: 'Ø¹Ù†Ø¯Ùƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø­Ø§Ù„ÙŠØ©ØŸ ğŸ“Š',
      type: 'select',
      options: [{ value: 'no', label: 'Ù„Ø§' }, { value: 'yes', label: 'Ù†Ø¹Ù…' }],
      required: true
    },
    {
      id: 'obligationAmount',
      title: 'ÙƒÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ ğŸ’¸',
      type: 'number',
      placeholder: 'Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø±ÙŠØ§Ù„',
      condition: () => clientData.hasObligations === 'yes',
      required: true
    },
    {
      id: 'obligationMonths',
      title: 'ÙƒÙ… Ø´Ù‡Ø± Ù…ØªØ¨Ù‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…ØŸ ğŸ“…',
      type: 'number',
      placeholder: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø±',
      condition: () => clientData.hasObligations === 'yes',
      required: true
    }
  ];
  
  // ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„Ø´Ø±ÙˆØ·
  totalQuestions = questions.filter(q => !q.condition || q.condition()).length;
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
function displayQuestion() {
  // ØªØ®Ø·ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙŠ Ù„Ø§ ØªÙ†Ø·Ø¨Ù‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ø´Ø±ÙˆØ·
  while (currentQuestion < questions.length && questions[currentQuestion].condition && !questions[currentQuestion].condition()) {
    currentQuestion++;
  }
  
  if (currentQuestion >= questions.length) {
    calculateResult();
    return;
  }
  
  const q = questions[currentQuestion];
  const questionDiv = document.getElementById('question');
  
  // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
  const visibleQuestions = questions.filter((q, i) => i <= currentQuestion && (!q.condition || q.condition()));
  const progress = (visibleQuestions.length / totalQuestions) * 100;
  document.getElementById('progressFill').style.width = progress + '%';
  document.getElementById('progressText').textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${visibleQuestions.length} Ù…Ù† ${totalQuestions}`;
  
  let html = `<div style="font-size: 18px; font-weight: 700; margin-bottom: 15px;">${q.title}</div>`;
  
  switch (q.type) {
    case 'text':
      html += `<input type="text" id="answer" placeholder="${q.placeholder || ''}" onkeypress="if(event.key==='Enter')nextQuestion()">`;
      break;
      
    case 'number':
      html += `<input type="number" id="answer" placeholder="${q.placeholder || ''}" min="${q.min || 0}" onkeypress="if(event.key==='Enter')nextQuestion()">`;
      break;
      
    case 'select':
      html += `<select id="answer" onchange="if(this.value)setTimeout(nextQuestion,300)">`;
      html += `<option value="">Ø§Ø®ØªØ±...</option>`;
      q.options.forEach(opt => {
        html += `<option value="${opt.value}">${opt.label}</option>`;
      });
      html += `</select>`;
      break;
      
    case 'date-hijri':
      html += `
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
          <div>
            <label style="font-size: 13px;">Ø§Ù„ÙŠÙˆÙ…</label>
            <select id="answerDay">
              <option value="">Ø§Ù„ÙŠÙˆÙ…</option>
              ${Array.from({length: 30}, (_, i) => `<option value="${i+1}">${i+1}</option>`).join('')}
            </select>
          </div>
          <div>
            <label style="font-size: 13px;">Ø§Ù„Ø´Ù‡Ø±</label>
            <select id="answerMonth">
              <option value="">Ø§Ù„Ø´Ù‡Ø±</option>
              <option value="1">Ù…Ø­Ø±Ù…</option>
              <option value="2">ØµÙØ±</option>
              <option value="3">Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„</option>
              <option value="4">Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
              <option value="5">Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø£ÙˆÙ„Ù‰</option>
              <option value="6">Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø¢Ø®Ø±Ø©</option>
              <option value="7">Ø±Ø¬Ø¨</option>
              <option value="8">Ø´Ø¹Ø¨Ø§Ù†</option>
              <option value="9">Ø±Ù…Ø¶Ø§Ù†</option>
              <option value="10">Ø´ÙˆØ§Ù„</option>
              <option value="11">Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©</option>
              <option value="12">Ø°Ùˆ Ø§Ù„Ø­Ø¬Ø©</option>
            </select>
          </div>
          <div>
            <label style="font-size: 13px;">Ø§Ù„Ø³Ù†Ø©</label>
            <select id="answerYear">
              <option value="">Ø§Ù„Ø³Ù†Ø©</option>
              ${Array.from({length: 70}, (_, i) => {
                const year = 1380 + i;
                return `<option value="${year}">${year}</option>`;
              }).join('')}
            </select>
          </div>
        </div>
      `;
      break;
  }
  
  questionDiv.innerHTML = html;
  
  // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù‚Ù„
  setTimeout(() => {
    const input = document.getElementById('answer') || document.getElementById('answerDay');
    if (input) input.focus();
  }, 100);
}

// Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ
function nextQuestion() {
  const q = questions[currentQuestion];
  let answer;
  
  if (q.type === 'date-hijri') {
    const day = document.getElementById('answerDay').value;
    const month = document.getElementById('answerMonth').value;
    const year = document.getElementById('answerYear').value;
    
    if (!day || !month || !year) {
      showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ®', 'error');
      return;
    }
    
    answer = { day: parseInt(day), month: parseInt(month), year: parseInt(year) };
  } else {
    answer = document.getElementById('answer').value;
    
    if (q.required && !answer) {
      showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„', 'error');
      return;
    }
    
    if (q.type === 'number') {
      answer = parseFloat(answer);
      if (q.min && answer < q.min) {
        showToast(`Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù‡Ùˆ ${q.min}`, 'error');
        return;
      }
    }
  }
  
  clientData[q.id] = answer;
  currentQuestion++;
  
  // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙˆØ·
  buildQuestions();
  
  displayQuestion();
}

// Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø¨Ø©
function resetCalculator() {
  clientData = {};
  currentQuestion = 0;
  showPage('landing');
}

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©
function calculateResult() {
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±
  const birthDate = clientData.birthDate || { day: 1, month: 1, year: 1400 };
  const currentHijriYearStr = new Date().toLocaleDateString('ar-SA-u-ca-islamic-umalqura', { year: 'numeric' });
  const currentHijriYear = parseInt(currentHijriYearStr.replace(/[^0-9]/g, '')) || 1446;
  const age = currentHijriYear - birthDate.year;
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù…ØªØ§Ø­ Ù„Ù„ØªÙ…ÙˆÙŠÙ„ (Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª)
  let availableSalary = clientData.salary;
  if (clientData.hasObligations === 'yes') {
    availableSalary -= clientData.obligationAmount;
  }
  
  // Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ‚Ø·Ø§Ø¹ (33% Ù„Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø´Ø®ØµÙŠØŒ 65% Ù„Ù„Ø¹Ù‚Ø§Ø±ÙŠ)
  let deductionRate = clientData.financeType === 'mortgage' ? 0.65 : 0.33;
  let maxInstallment = availableSalary * deductionRate;
  
  // Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ (Ø§ÙØªØ±Ø§Ø¶ÙŠØ©)
  let profitRate = clientData.financeType === 'mortgage' ? 0.045 : 0.055;
  
  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù†Ø³Ø¨Ø© Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø­Ø¯Ø¯
  if (clientData.preferredBank !== 'auto') {
    const bankConfig = bankConfigs.find(c => c.bank === clientData.preferredBank && c.type === clientData.financeType);
    if (bankConfig) {
      profitRate = bankConfig.margin / 100;
    }
  }
  
  // Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø¨Ø§Ù„Ø£Ø´Ù‡Ø±
  const duration = parseInt(clientData.duration);
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ
  // Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ = (Ø§Ù„Ù…Ø¨Ù„Øº Ã— (1 + Ø§Ù„Ù†Ø³Ø¨Ø© Ã— Ø§Ù„Ù…Ø¯Ø©/12)) / Ø§Ù„Ù…Ø¯Ø©
  // Ø§Ù„Ù…Ø¨Ù„Øº = Ø§Ù„Ù‚Ø³Ø· Ã— Ø§Ù„Ù…Ø¯Ø© / (1 + Ø§Ù„Ù†Ø³Ø¨Ø© Ã— Ø§Ù„Ù…Ø¯Ø©/12)
  const totalRate = 1 + (profitRate * duration / 12);
  const financeAmount = Math.floor((maxInstallment * duration) / totalRate);
  
  // Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ
  const monthlyInstallment = Math.ceil((financeAmount * totalRate) / duration);
  
  // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¯Ø§Ø¯
  const totalPayment = monthlyInstallment * duration;
  
  // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
  const totalProfit = totalPayment - financeAmount;
  
  // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ù†Ùƒ
  let selectedBank = clientData.preferredBank;
  if (selectedBank === 'auto') {
    // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ø¨Ù†Ùƒ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø©
    const activeBanks = banks.filter(b => b.active);
    selectedBank = activeBanks[Math.floor(Math.random() * activeBanks.length)]?.name || 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ';
  }
  
  // Ø­Ø³Ø§Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠÙŠÙ†
  let retirementInfo = null;
  if (clientData.jobType === 'military' && clientData.extendedFinance === 'yes') {
    const hireDate = clientData.hireDate || { day: 1, month: 1, year: 1420 };
    const serviceYears = currentHijriYear - (hireDate.year || 1420);
    const retirementAge = 55; // Ø³Ù† Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠÙŠÙ†
    const yearsToRetirement = Math.max(0, retirementAge - age);
    const retirementYear = currentHijriYear + yearsToRetirement;
    const retirementSalary = Math.floor((clientData.salary || 10000) * 0.7); // ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ 70% Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨
    
    retirementInfo = {
      serviceYears: serviceYears || 0,
      yearsToRetirement: yearsToRetirement || 0,
      retirementYear: retirementYear || currentHijriYear,
      retirementSalary: retirementSalary || 7000
    };
  }
  
  // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  const result = {
    id: Date.now(),
    date: new Date().toISOString(),
    clientName: clientData.name,
    age,
    jobType: clientData.jobType,
    financeType: clientData.financeType,
    salary: clientData.salary,
    financeAmount,
    monthlyInstallment,
    duration,
    profitRate: profitRate * 100,
    totalPayment,
    totalProfit,
    selectedBank,
    retirementInfo
  };
  
  clientResults.push(result);
  localStorage.setItem('clientResults', JSON.stringify(clientResults.slice(-100))); // Ø­ÙØ¸ Ø¢Ø®Ø± 100 Ù†ØªÙŠØ¬Ø©
  
  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  displayResult(result);
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
function displayResult(result) {
  showPage('result');
  
  const bankInfo = banks.find(b => b.name === result.selectedBank) || { logo: 'ğŸ¦', name: result.selectedBank };
  const financeProduct = financeProducts.find(p => p.id === result.financeType) || { icon: 'ğŸ’°', name: 'ØªÙ…ÙˆÙŠÙ„' };
  const jobType = jobTypes.find(j => j.id === result.jobType) || { name: 'Ù…ÙˆØ¸Ù' };
  
  const randomGreeting = marketingMessages[Math.floor(Math.random() * marketingMessages.length)];
  const randomMessage = resultMessages[Math.floor(Math.random() * resultMessages.length)];
  
  let html = `
    <div class="result-header" style="margin-bottom: 15px;">
      <div class="client-chip">ğŸ‘¤ ${result.clientName}</div>
      <div>
        <span class="badge-mode">${financeProduct.icon} ${financeProduct.name}</span>
        <span class="badge-duration">ğŸ“… ${result.duration} Ø´Ù‡Ø±</span>
      </div>
    </div>
    
    <div style="font-size: 14px; color: var(--accent-color); margin-bottom: 10px;">${randomGreeting}</div>
  `;
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠÙŠÙ†
  if (result.retirementInfo) {
    html += `
      <div class="retirement-box">
        <div class="retirement-title">ğŸ–ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ</div>
        <div class="retirement-row">
          <span>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</span>
          <span>${result.retirementInfo.retirementYear} Ù‡Ù€</span>
        </div>
        <div class="retirement-row">
          <span>Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„ØªÙ‚Ø§Ø¹Ø¯</span>
          <span>${result.retirementInfo.yearsToRetirement} Ø³Ù†Ø©</span>
        </div>
        <div class="retirement-row">
          <span>Ø±Ø§ØªØ¨ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ (ØªÙ‚Ø¯ÙŠØ±ÙŠ)</span>
          <span>${result.retirementInfo.retirementSalary.toLocaleString('ar-SA')} Ø±.Ø³</span>
        </div>
      </div>
    `;
  }
  
  html += `
    <div class="bank-card">
      <div class="bank-logo">${bankInfo.logo}</div>
      <div>
        <div class="bank-text-main">${bankInfo.name}</div>
        <div class="bank-text-sub">Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±Ø´Ø­ Ù„Ùƒ</div>
      </div>
    </div>
    
    <div class="result-main-block">
      <div class="result-main-title">ğŸ’° Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</div>
      <div class="result-amount-main">${result.financeAmount.toLocaleString('ar-SA')} Ø±.Ø³</div>
      <div class="result-amount-words">${numberToArabicWords(result.financeAmount)} Ø±ÙŠØ§Ù„</div>
    </div>
    
    <div class="result-details">
      <div class="result-row">
        <span class="label">Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ</span>
        <span class="value">${result.monthlyInstallment.toLocaleString('ar-SA')} Ø±.Ø³</span>
      </div>
      <div class="result-row">
        <span class="label">Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„</span>
        <span class="value">${result.duration} Ø´Ù‡Ø± (${Math.floor(result.duration/12)} Ø³Ù†Ø©)</span>
      </div>
      <div class="result-row">
        <span class="label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠØ©</span>
        <span class="value">${result.profitRate.toFixed(2)}%</span>
      </div>
      <div class="result-row">
        <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¯Ø§Ø¯</span>
        <span class="value">${result.totalPayment.toLocaleString('ar-SA')} Ø±.Ø³</span>
      </div>
      <div class="result-row">
        <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</span>
        <span class="value">${result.totalProfit.toLocaleString('ar-SA')} Ø±.Ø³</span>
      </div>
    </div>
    
    <div style="font-size: 14px; color: var(--text-secondary); margin-top: 15px; padding: 10px; background: #f8fafc; border-radius: 12px;">
      ${randomMessage}
    </div>
  `;
  
  document.getElementById('resultCard').innerHTML = html;
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
  if (features.ratings) {
    document.getElementById('ratingCard').style.display = 'block';
    setupStarRating();
  }
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ø¹Ù‚Ø¯
  if (features.contract && platformSettings.contractUrl) {
    document.getElementById('contractBtn').style.display = 'block';
    document.getElementById('contractBtnText').textContent = platformSettings.contractText;
  }
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø§Ù„Ù†Ø¬ÙˆÙ…
function setupStarRating() {
  const stars = document.querySelectorAll('#starRating .star');
  let selectedRating = 0;
  
  stars.forEach(star => {
    star.addEventListener('click', () => {
      selectedRating = parseInt(star.dataset.rating);
      stars.forEach((s, i) => {
        s.classList.toggle('active', i < selectedRating);
      });
    });
  });
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
function submitRating() {
  const stars = document.querySelectorAll('#starRating .star.active');
  const rating = stars.length;
  const comment = document.getElementById('ratingComment').value;
  
  if (rating === 0) {
    showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…', 'error');
    return;
  }
  
  ratings.push({
    id: Date.now(),
    date: new Date().toISOString(),
    clientName: clientData.name,
    rating,
    comment
  });
  
  localStorage.setItem('ratings', JSON.stringify(ratings.slice(-50)));
  
  document.getElementById('ratingCard').innerHTML = `
    <div style="font-size: 40px; margin-bottom: 10px;">ğŸ’š</div>
    <div style="font-size: 16px; font-weight: 700;">Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙ‚ÙŠÙŠÙ…Ùƒ!</div>
  `;
  
  showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­', 'success');
}

// Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
function displayRatings() {
  const goodRatings = ratings.filter(r => r.rating >= 4).slice(-5);
  if (goodRatings.length === 0) return;
  
  document.getElementById('ratingsSection').style.display = 'block';
  
  let html = '';
  goodRatings.forEach(r => {
    html += `
      <div style="text-align: right; padding: 10px; background: #f8fafc; border-radius: 12px; margin-bottom: 8px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-weight: 700;">${r.clientName}</span>
          <span style="color: #f59e0b;">${'â˜…'.repeat(r.rating)}${'â˜†'.repeat(5-r.rating)}</span>
        </div>
        ${r.comment ? `<div style="font-size: 13px; color: var(--text-secondary); margin-top: 5px;">${r.comment}</div>` : ''}
      </div>
    `;
  });
  
  document.getElementById('ratingsList').innerHTML = html;
}

</script>

<script>
// ==================== Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ± ====================

function calculateEarlySettlement() {
  const financeType = document.getElementById('esFinanceType').value;
  const originalAmount = parseFloat(document.getElementById('esOriginalAmount').value);
  const totalMonths = parseInt(document.getElementById('esTotalMonths').value);
  const paidMonths = parseInt(document.getElementById('esPaidMonths').value);
  const annualRate = parseFloat(document.getElementById('esRate').value) / 100;
  
  if (!financeType || !originalAmount || !totalMonths || !paidMonths || !annualRate) {
    showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
    return;
  }
  
  if (paidMonths >= totalMonths) {
    showToast('Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…Ø³Ø¯Ø¯Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ù…Ø¯Ø© Ø§Ù„ÙƒÙ„ÙŠØ©', 'error');
    return;
  }
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ
  const monthlyRate = annualRate / 12;
  const totalRate = 1 + (annualRate * totalMonths / 12);
  const monthlyInstallment = (originalAmount * totalRate) / totalMonths;
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† Ø§Ù„Ø£ØµÙ„ (Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªÙ†Ø§Ù‚Øµ)
  let remainingPrincipal = originalAmount;
  for (let i = 0; i < paidMonths; i++) {
    const interestPortion = remainingPrincipal * monthlyRate;
    const principalPortion = monthlyInstallment - interestPortion;
    remainingPrincipal -= principalPortion;
  }
  remainingPrincipal = Math.max(0, remainingPrincipal);
  
  // Ø­Ø³Ø§Ø¨ ÙƒÙ„ÙØ© 3 Ø£Ø´Ù‡Ø± Ù‚Ø§Ø¯Ù…Ø© (Ø­Ø³Ø¨ Ù†Ø¸Ø§Ù… Ø³Ø§Ù…Ø§)
  let threeMonthsCost = 0;
  let tempPrincipal = remainingPrincipal;
  for (let i = 0; i < 3 && i < (totalMonths - paidMonths); i++) {
    threeMonthsCost += tempPrincipal * monthlyRate;
    const principalPortion = monthlyInstallment - (tempPrincipal * monthlyRate);
    tempPrincipal -= principalPortion;
  }
  
  // Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±
  const earlySettlementAmount = remainingPrincipal + threeMonthsCost;
  
  // Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ÙˆÙØ±
  const remainingMonths = totalMonths - paidMonths;
  const remainingPayments = monthlyInstallment * remainingMonths;
  const savedAmount = remainingPayments - earlySettlementAmount;
  const savingPercentage = (savedAmount / remainingPayments) * 100;
  
  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  const resultDiv = document.getElementById('esResult');
  resultDiv.style.display = 'block';
  resultDiv.innerHTML = `
    <div class="result-main-block">
      <div class="result-main-title">ğŸ’° Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±</div>
      <div class="result-amount-main">${Math.ceil(earlySettlementAmount).toLocaleString('ar-SA')} Ø±.Ø³</div>
    </div>
    
    <div class="result-details" style="margin-top: 15px;">
      <div class="result-row">
        <span class="label">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† Ø§Ù„Ø£ØµÙ„</span>
        <span class="value">${Math.ceil(remainingPrincipal).toLocaleString('ar-SA')} Ø±.Ø³</span>
      </div>
      <div class="result-row">
        <span class="label">ÙƒÙ„ÙØ© 3 Ø£Ø´Ù‡Ø± Ù‚Ø§Ø¯Ù…Ø©</span>
        <span class="value">${Math.ceil(threeMonthsCost).toLocaleString('ar-SA')} Ø±.Ø³</span>
      </div>
      <div class="result-row">
        <span class="label">Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© (Ù„Ùˆ Ø£ÙƒÙ…Ù„Øª)</span>
        <span class="value">${Math.ceil(remainingPayments).toLocaleString('ar-SA')} Ø±.Ø³</span>
      </div>
      <div class="result-row" style="background: #dcfce7; padding: 10px; border-radius: 10px; margin-top: 10px;">
        <span class="label" style="color: #166534; font-weight: 700;">ğŸ’š Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ÙˆÙØ±</span>
        <span class="value" style="color: #166534;">${Math.ceil(savedAmount).toLocaleString('ar-SA')} Ø±.Ø³ (${savingPercentage.toFixed(1)}%)</span>
      </div>
    </div>
    
    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 15px; padding: 10px; background: #fef3c7; border-radius: 10px; text-align: right;">
      âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ ØªÙ‚Ø±ÙŠØ¨ÙŠ ÙˆÙÙ‚Ø§Ù‹ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ (Ø³Ø§Ù…Ø§). Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¯Ù‚ÙŠÙ‚ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¨Ù†Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø©.
    </div>
  `;
}

// ==================== Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§Ù„Ø­ÙØ¸ ====================

// Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§ØªØ³Ø§Ø¨
function shareWhatsApp() {
  const result = clientResults[clientResults.length - 1];
  if (!result) return;
  
  const text = `*Ù†ØªÙŠØ¬Ø© Ø­Ø§Ø³Ø¨Ø© FINO*
  
ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${result.clientName}
ğŸ’° Ø§Ù„ØªÙ…ÙˆÙŠÙ„: ${result.financeAmount.toLocaleString('ar-SA')} Ø±.Ø³
ğŸ“… Ø§Ù„Ù…Ø¯Ø©: ${result.duration} Ø´Ù‡Ø±
ğŸ’µ Ø§Ù„Ù‚Ø³Ø·: ${result.monthlyInstallment.toLocaleString('ar-SA')} Ø±.Ø³
ğŸ¦ Ø§Ù„Ø¨Ù†Ùƒ: ${result.selectedBank}
ğŸ“Š Ø§Ù„Ù†Ø³Ø¨Ø©: ${result.profitRate.toFixed(2)}%

_ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¨Ø± Ù…Ù†ØµØ© FINO_`;
  
  const url = `https://wa.me/${platformSettings.whatsapp}?text=${encodeURIComponent(text)}`;
  window.open(url, '_blank');
}

// Ø­ÙØ¸ ÙƒØµÙˆØ±Ø©
async function saveAsImage() {
  const resultCard = document.getElementById('resultCard');
  
  try {
    showToast('Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©...', 'info');
    
    const canvas = await html2canvas(resultCard, {
      backgroundColor: '#ffffff',
      scale: 2,
      useCORS: true
    });
    
    const link = document.createElement('a');
    link.download = `FINO_Result_${Date.now()}.png`;
    link.href = canvas.toDataURL('image/png');
    link.click();
    
    showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
  } catch (error) {
    showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©', 'error');
  }
}

// ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ù‚Ø¯
function openContract() {
  if (platformSettings.contractUrl) {
    window.open(platformSettings.contractUrl, '_blank');
  }
}

// ==================== Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ====================

// ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù‚Ù‚
function openAdminAuth() {
  document.getElementById('adminAuthModal').classList.add('active');
  document.getElementById('adminPassword').value = '';
  document.getElementById('adminPassword').focus();
}

// Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù‚Ù‚
function closeAdminAuth() {
  document.getElementById('adminAuthModal').classList.remove('active');
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
function verifyAdmin() {
  const password = document.getElementById('adminPassword').value;
  
  // ØªØ³Ø¬ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
  const attempt = {
    date: new Date().toISOString(),
    success: password === ADMIN_CODE,
    userAgent: navigator.userAgent
  };
  
  // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        attempt.location = {
          lat: pos.coords.latitude,
          lng: pos.coords.longitude
        };
        saveLoginAttempt(attempt);
      },
      () => saveLoginAttempt(attempt)
    );
  } else {
    saveLoginAttempt(attempt);
  }
  
  if (password === ADMIN_CODE) {
    closeAdminAuth();
    showPage('adminHub');
    showToast('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'success');
    updateAdminUI();
  } else {
    showToast('Ø±Ù…Ø² Ø®Ø§Ø·Ø¦', 'error');
  }
}

// Ø­ÙØ¸ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
function saveLoginAttempt(attempt) {
  loginAttempts.push(attempt);
  localStorage.setItem('loginAttempts', JSON.stringify(loginAttempts.slice(-100)));
}

// ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
function updateAdminUI() {
  // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù‚ÙÙ„
  document.getElementById('lockIcon').textContent = platformSettings.isLocked ? 'ğŸ”’' : 'ğŸ”“';
  document.getElementById('lockText').textContent = platformSettings.isLocked ? 'ÙØªØ­ Ø§Ù„Ù…Ù†ØµØ©' : 'Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©';
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  document.getElementById('settingWhatsapp').value = platformSettings.whatsapp || '';
  document.getElementById('settingContractUrl').value = platformSettings.contractUrl || '';
  document.getElementById('settingContractText').value = platformSettings.contractText || '';
  document.getElementById('settingMarketingText').value = platformSettings.marketingText || '';
  document.getElementById('settingMaxAge').value = platformSettings.maxAge || 60;
  document.getElementById('settingAgeMethod').value = platformSettings.ageMethod || 'hijri';
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Øª
  Object.keys(features).forEach(key => {
    const toggle = document.getElementById('toggle' + key.charAt(0).toUpperCase() + key.slice(1));
    if (toggle) {
      toggle.classList.toggle('active', features[key]);
    }
  });
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø«ÙŠÙ…
  document.getElementById('themeSelect').value = themeSettings.theme;
  document.getElementById('customPrimary').value = themeSettings.customPrimary;
  document.getElementById('customSecondary').value = themeSettings.customSecondary;
  document.getElementById('customAccent').value = themeSettings.customAccent;
  
  // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨Ù†ÙˆÙƒ
  updateBankConfigsTable();
}

// Ù‚ÙÙ„/ÙØªØ­ Ø§Ù„Ù…Ù†ØµØ©
function togglePlatformLock() {
  platformSettings.isLocked = !platformSettings.isLocked;
  localStorage.setItem('platformSettings', JSON.stringify(platformSettings));
  updateAdminUI();
  showToast(platformSettings.isLocked ? 'ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©' : 'ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ù†ØµØ©', 'success');
}

// Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ÙÙ„
function showLockScreen() {
  document.getElementById('landingPage').innerHTML = `
    <div class="card fade-in">
      <div style="font-size: 60px; margin-bottom: 15px;">ğŸ”’</div>
      <div style="font-size: 20px; font-weight: 800; margin-bottom: 10px;">Ø§Ù„Ù…Ù†ØµØ© Ù…ØºÙ„Ù‚Ø© Ù…Ø¤Ù‚ØªØ§Ù‹</div>
      <p style="font-size: 14px; color: var(--text-secondary);">${platformSettings.lockMessage}</p>
    </div>
  `;
}

// Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ù†Ùƒ
function saveBankConfig() {
  const config = {
    bank: document.getElementById('adminBankName').value,
    type: document.getElementById('adminFinanceType').value,
    minSalary: parseInt(document.getElementById('adminMinSalary').value) || 0,
    maxSalary: parseInt(document.getElementById('adminMaxSalary').value) || 0,
    margin: parseFloat(document.getElementById('adminMargin').value) || 0,
    maxAge: parseInt(document.getElementById('adminMaxAge').value) || 60
  };
  
  if (!config.bank) {
    showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ù†Ùƒ', 'error');
    return;
  }
  
  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ÙˆØ¬ÙˆØ¯
  const existingIndex = bankConfigs.findIndex(c => c.bank === config.bank && c.type === config.type);
  if (existingIndex >= 0) {
    bankConfigs[existingIndex] = config;
  } else {
    bankConfigs.push(config);
  }
  
  localStorage.setItem('bankConfigs', JSON.stringify(bankConfigs));
  updateBankConfigsTable();
  showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'success');
}

// ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ù†ÙˆÙƒ
function updateBankConfigsTable() {
  const tbody = document.querySelector('#bankConfigsTable tbody');
  if (!tbody) return;
  
  tbody.innerHTML = bankConfigs.map((c, i) => `
    <tr>
      <td>${c.bank}</td>
      <td>${c.type === 'personal' ? 'Ø´Ø®ØµÙŠ' : c.type === 'mortgage' ? 'Ø¹Ù‚Ø§Ø±ÙŠ' : 'Ø³ÙŠØ§Ø±Ø§Øª'}</td>
      <td>${c.minSalary}-${c.maxSalary}</td>
      <td>${c.margin}%</td>
      <td><button class="danger small" onclick="deleteBankConfig(${i})" style="padding: 5px 10px; font-size: 12px;">Ø­Ø°Ù</button></td>
    </tr>
  `).join('');
}

// Ø­Ø°Ù Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨Ù†Ùƒ
function deleteBankConfig(index) {
  bankConfigs.splice(index, 1);
  localStorage.setItem('bankConfigs', JSON.stringify(bankConfigs));
  updateBankConfigsTable();
  showToast('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'success');
}

// Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
function saveGeneralSettings() {
  platformSettings.whatsapp = document.getElementById('settingWhatsapp').value;
  platformSettings.contractUrl = document.getElementById('settingContractUrl').value;
  platformSettings.contractText = document.getElementById('settingContractText').value;
  platformSettings.marketingText = document.getElementById('settingMarketingText').value;
  platformSettings.maxAge = parseInt(document.getElementById('settingMaxAge').value) || 60;
  platformSettings.ageMethod = document.getElementById('settingAgeMethod').value;
  
  localStorage.setItem('platformSettings', JSON.stringify(platformSettings));
  showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'success');
}

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Øª
function toggleFeature(feature) {
  features[feature] = !features[feature];
  localStorage.setItem('features', JSON.stringify(features));
  
  const toggle = document.getElementById('toggle' + feature.charAt(0).toUpperCase() + feature.slice(1));
  if (toggle) {
    toggle.classList.toggle('active', features[feature]);
  }
  
  updateFeaturesUI();
  showToast(features[feature] ? 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø©' : 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙŠØ²Ø©', 'success');
}

// ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙŠØ²Ø§Øª
function updateFeaturesUI() {
  // Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª
  document.getElementById('particles').style.display = features.particles ? 'block' : 'none';
  
  // Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
  document.getElementById('timeGreeting').style.display = features.timeGreeting ? 'flex' : 'none';
  
  // Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±
  const esBtn = document.getElementById('earlySettlementBtn');
  if (esBtn) esBtn.style.display = features.earlySettlement ? 'block' : 'none';
  
  // Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
  const statsCounter = document.getElementById('statsCounter');
  if (statsCounter) statsCounter.style.display = features.stats ? 'block' : 'none';
  
  // Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
  const ratingsSection = document.getElementById('ratingsSection');
  if (ratingsSection) ratingsSection.style.display = features.ratings ? 'block' : 'none';
}

// ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ…
function changeTheme(theme) {
  themeSettings.theme = theme;
  
  if (theme === 'custom') {
    document.getElementById('customColors').style.display = 'block';
  } else {
    document.getElementById('customColors').style.display = 'none';
  }
  
  applyTheme();
}

// ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø«ÙŠÙ…
function applyTheme() {
  const themes = {
    blue: { primary: '#1e3a8a', secondary: '#3b82f6', accent: '#f59e0b' },
    green: { primary: '#166534', secondary: '#22c55e', accent: '#f59e0b' },
    purple: { primary: '#581c87', secondary: '#a855f7', accent: '#f59e0b' },
    gold: { primary: '#78350f', secondary: '#d97706', accent: '#fbbf24' },
    dark: { primary: '#0f172a', secondary: '#1e293b', accent: '#f59e0b' }
  };
  
  let colors;
  if (themeSettings.theme === 'custom') {
    colors = {
      primary: themeSettings.customPrimary,
      secondary: themeSettings.customSecondary,
      accent: themeSettings.customAccent
    };
  } else {
    colors = themes[themeSettings.theme] || themes.blue;
  }
  
  document.documentElement.style.setProperty('--primary-color', colors.primary);
  document.documentElement.style.setProperty('--secondary-color', colors.secondary);
  document.documentElement.style.setProperty('--accent-color', colors.accent);
  document.documentElement.style.setProperty('--bg-gradient-2', colors.primary);
  document.documentElement.style.setProperty('--bg-gradient-3', colors.secondary);
}

// Ø­ÙØ¸ Ø§Ù„Ø«ÙŠÙ…
function saveTheme() {
  if (themeSettings.theme === 'custom') {
    themeSettings.customPrimary = document.getElementById('customPrimary').value;
    themeSettings.customSecondary = document.getElementById('customSecondary').value;
    themeSettings.customAccent = document.getElementById('customAccent').value;
  }
  
  localStorage.setItem('themeSettings', JSON.stringify(themeSettings));
  applyTheme();
  showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø«ÙŠÙ…', 'success');
}

// ==================== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ====================
document.addEventListener('DOMContentLoaded', initPlatform);

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
document.getElementById('adminAuthModal').addEventListener('click', function(e) {
  if (e.target === this) closeAdminAuth();
});

// Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter ÙÙŠ Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
document.getElementById('adminPassword').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') verifyAdmin();
});
</script>

</body>
</html>
