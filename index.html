<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù…Ù†ØµØ© FINO - ØªØ±Ø´ÙŠØ­ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Tajawal', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(180deg, #0f172a 0%, #1e3a8a 100%);
      min-height: 100vh;
      margin: 0;
      text-align: center;
      font-size: 18px;
      direction: rtl;
      color: #111827;
    }
    
    header {
      background: transparent;
      color: #fff;
      padding: 20px 10px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 800;
      letter-spacing: 0.03em;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    header p {
      margin: 8px 0 0;
      font-size: 14px;
      opacity: 0.9;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .page-container {
      max-width: 500px;
      margin: 0 auto 32px;
      padding: 0 15px;
    }
    
    .card {
      background: #ffffff;
      border-radius: 24px;
      padding: 24px 20px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      margin-bottom: 16px;
      text-align: center;
      width: 100%;
    }

    button, .btn {
      border-radius: 999px;
      border: none;
      padding: 14px 28px;
      font-size: 17px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s ease;
      font-weight: 600;
    }
    button.primary, .btn.primary {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      color: #ffffff;
      box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
    }
    button.primary:hover, .btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 28px rgba(37, 99, 235, 0.5);
    }
    button.secondary, .btn.secondary {
      background: #f1f5f9;
      color: #1e40af;
      border: 1px solid #e2e8f0;
    }
    button.secondary:hover, .btn.secondary:hover {
      background: #e2e8f0;
    }
    button.small, .btn.small {
      padding: 10px 18px;
      font-size: 14px;
    }
    button.gold, .btn.gold {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: #fff;
      box-shadow: 0 6px 16px rgba(245, 158, 11, 0.4);
    }
    button.whatsapp {
      background: #25D366;
      color: #fff;
    }

    input, select, textarea {
      width: 100%;
      padding: 14px 16px;
      margin: 8px 0;
      font-size: 17px;
      border-radius: 14px;
      border: 2px solid #e2e8f0;
      text-align: right;
      background: #f8fafc;
      color: #111827;
      transition: all 0.2s ease;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
      background: #ffffff;
    }
    label {
      display: block;
      text-align: right;
      font-size: 16px;
      margin-top: 12px;
      margin-bottom: 4px;
      color: #374151;
      font-weight: 600;
    }

    .fade-in {
      animation: fadeInMove 0.4s ease-out forwards;
      opacity: 0;
      transform: translateY(15px);
    }
    @keyframes fadeInMove {
      to { opacity: 1; transform: translateY(0); }
    }

    .page { display: none; }
    .page.active { display: block; }

    .welcome-title {
      font-size: 24px;
      margin-bottom: 8px;
      color: #111827;
      font-weight: 700;
    }
    .welcome-sub {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 20px;
      line-height: 1.7;
    }

    /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© */
    .option-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 12px 0;
    }
    .option-btn {
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      border-radius: 16px;
      padding: 16px 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      font-size: 15px;
      color: #374151;
    }
    .option-btn:hover, .option-btn.selected {
      border-color: #2563eb;
      background: #eff6ff;
      color: #1d4ed8;
    }
    .option-btn.selected {
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
    }

    /* Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ */
    .result-box {
      background: linear-gradient(135deg, #eff6ff, #dbeafe);
      border-radius: 20px;
      padding: 20px;
      margin: 16px 0;
      border: 1px solid #bfdbfe;
    }
    .result-amount {
      font-size: 32px;
      font-weight: 800;
      color: #1e40af;
      margin: 8px 0;
    }
    .result-amount-words {
      font-size: 14px;
      color: #3b82f6;
      margin-bottom: 8px;
    }
    .result-label {
      font-size: 13px;
      color: #64748b;
      margin-bottom: 4px;
    }
    
    .money-icon {
      font-size: 24px;
      margin-left: 8px;
    }

    /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ */
    .retirement-box {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border-radius: 16px;
      padding: 16px;
      margin: 12px 0;
      border: 1px solid #fbbf24;
      text-align: right;
    }
    .retirement-box h4 {
      margin: 0 0 8px;
      color: #92400e;
      font-size: 14px;
    }
    .retirement-info {
      font-size: 13px;
      color: #78350f;
      line-height: 1.8;
    }

    /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¨Ù†Ùƒ */
    .bank-card {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 16px;
      border-radius: 18px;
      background: #fff;
      border: 2px dashed #3b82f6;
      margin: 12px 0;
      text-align: right;
    }
    .bank-logo {
      width: 56px;
      height: 56px;
      border-radius: 14px;
      background: #f8fafc;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      flex-shrink: 0;
      border: 1px solid #e2e8f0;
    }
    .bank-logo img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    .bank-name {
      font-size: 16px;
      font-weight: 700;
      color: #1e40af;
    }
    .bank-rate {
      font-size: 13px;
      color: #64748b;
    }

    /* Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
    .ad-box {
      background: linear-gradient(135deg, #ecfdf5, #d1fae5);
      border-radius: 16px;
      padding: 16px;
      margin: 16px 0;
      border: 1px solid #6ee7b7;
      text-align: right;
    }
    .ad-title {
      font-size: 15px;
      font-weight: 700;
      color: #065f46;
      margin-bottom: 6px;
    }
    .ad-text {
      font-size: 13px;
      color: #047857;
      line-height: 1.6;
    }

    /* Ø§Ù„ØªÙ‚ÙŠÙŠÙ… */
    .rating-box {
      background: #f8fafc;
      border-radius: 16px;
      padding: 16px;
      margin: 16px 0;
      border: 1px solid #e2e8f0;
    }
    .stars {
      font-size: 28px;
      cursor: pointer;
      color: #d1d5db;
    }
    .stars span.active {
      color: #fbbf24;
    }

    /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø®ÙÙŠØ© */
    .admin-icon-hidden {
      position: fixed;
      bottom: 10px;
      left: 10px;
      width: 20px;
      height: 20px;
      opacity: 0.1;
      cursor: pointer;
      font-size: 10px;
      color: #fff;
      z-index: 100;
    }
    .admin-icon-hidden:hover {
      opacity: 0.3;
    }

    /* Ø§Ù„ÙÙˆØªØ± */
    footer {
      font-size: 12px;
      color: rgba(255,255,255,0.7);
      padding: 16px;
      text-align: center;
    }
    footer a {
      color: rgba(255,255,255,0.9);
      text-decoration: none;
    }

    /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: #fff;
      border-radius: 24px;
      padding: 24px;
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    .modal-title {
      font-size: 18px;
      font-weight: 700;
      color: #111827;
    }
    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #6b7280;
      padding: 0;
    }

    /* Ø¬Ø¯Ø§ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ */
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
      font-size: 12px;
    }
    .admin-table th, .admin-table td {
      border: 1px solid #e2e8f0;
      padding: 8px 6px;
      text-align: center;
    }
    .admin-table th {
      background: #f1f5f9;
      color: #374151;
      font-weight: 600;
    }
    .admin-table tr:hover {
      background: #f8fafc;
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
    .progress-bar {
      height: 4px;
      background: #e2e8f0;
      border-radius: 2px;
      margin: 16px 0;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #2563eb, #3b82f6);
      border-radius: 2px;
      transition: width 0.3s ease;
    }

    /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ */
    .marketing-msg {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border-radius: 12px;
      padding: 12px 16px;
      margin: 12px 0;
      font-size: 14px;
      color: #92400e;
      text-align: right;
      line-height: 1.7;
    }

    /* ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
    .alert-error {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 12px 16px;
      color: #b91c1c;
      font-size: 14px;
      text-align: right;
      margin: 12px 0;
    }
    .alert-success {
      background: #ecfdf5;
      border: 1px solid #6ee7b7;
      border-radius: 12px;
      padding: 12px 16px;
      color: #065f46;
      font-size: 14px;
      text-align: right;
      margin: 12px 0;
    }
    .alert-info {
      background: #eff6ff;
      border: 1px solid #93c5fd;
      border-radius: 12px;
      padding: 12px 16px;
      color: #1e40af;
      font-size: 14px;
      text-align: right;
      margin: 12px 0;
    }

    /* ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ÙÙŠ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© */
    .date-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
    }
    .date-row select {
      text-align: center;
    }

    /* Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø¨Ø© Ø§Ù„ØµØºÙŠØ± */
    .reset-btn-small {
      background: transparent;
      border: 1px solid #e2e8f0;
      color: #6b7280;
      padding: 6px 12px;
      font-size: 12px;
      border-radius: 8px;
    }
    .reset-btn-small:hover {
      background: #f1f5f9;
    }

    /* Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§ØªØ³Ø§Ø¨ */
    .whatsapp-float {
      position: fixed;
      bottom: 80px;
      left: 20px;
      background: #25D366;
      color: #fff;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      box-shadow: 0 4px 16px rgba(37, 211, 102, 0.4);
      cursor: pointer;
      z-index: 99;
      text-decoration: none;
    }
  </style>
</head>
<body>

<header>
  <h1>ğŸ’° Ù…Ù†ØµØ© FINO</h1>
  <p>Ù…Ù†ØµØ© Ø°ÙƒÙŠØ© ØªØ­Ø³Ø¨ Ù„Ùƒ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØªÙØ±Ø´Ù‘Ø­ Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù†Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø±Ø§ØªØ¨Ùƒ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„ØªØ²Ø§Ù…Ø§ØªÙƒ Ø®Ù„Ø§Ù„ Ø«ÙˆØ§Ù†Ù</p>
</header>

<div class="page-container">

  <!-- ==================== ØµÙØ­Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ ==================== -->
  <div id="landingPage" class="page active">
    <div class="card fade-in">
      <div class="welcome-title">Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ ğŸ‘‹</div>
      <div class="welcome-sub">
        Ù…Ù† Ù‡Ù†Ø§ ØªÙ‚Ø¯Ø± ØªØ­Ø³Ø¨ ØªÙ…ÙˆÙŠÙ„Ùƒ ÙˆØªØ´ÙˆÙ Ø£ÙØ¶Ù„ Ø¨Ù†Ùƒ ÙŠÙ†Ø§Ø³Ø¨Ùƒ Ù…Ù† Ø­ÙŠØ« Ø§Ù„Ù†Ø³Ø¨Ø© Ø­Ø³Ø¨ Ø±Ø§ØªØ¨Ùƒ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„ØªØ²Ø§Ù…Ø§ØªÙƒ.
        <br><br>
        <strong>Ù†Ù†Ø¬Ø² ØªÙ…ÙˆÙŠÙ„Ùƒ Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª!</strong>
      </div>
      <button class="primary" onclick="startCalculator()" style="width:100%;">
        Ø§Ø¨Ø¯Ø£ Ø¨Ø£Ø³Ù… Ø§Ù„Ù„Ù‡ â˜ï¸
      </button>
      
      <div id="reviewsSection" style="margin-top:20px; display:none;">
        <div style="font-size:14px; color:#6b7280; margin-bottom:10px;">Ø¢Ø±Ø§Ø¡ Ø¹Ù…Ù„Ø§Ø¦Ù†Ø§ â­</div>
        <div id="reviewsList"></div>
      </div>
    </div>
  </div>

  <!-- ==================== ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ==================== -->
  <div id="calculatorPage" class="page">
    <div class="card">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width:0%"></div>
      </div>
      <div id="questionContainer"></div>
      <div id="buttonsContainer" style="margin-top:16px; display:flex; justify-content:center; gap:10px; flex-wrap:wrap;">
      </div>
    </div>
  </div>

  <!-- ==================== ØµÙØ­Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© ==================== -->
  <div id="resultPage" class="page">
    <div class="card fade-in" id="resultCard">
      <!-- ØªØ¹Ø¨Ø¦Ø© Ù…Ù† Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
    </div>
    
    <div style="display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-top:16px;">
      <button class="whatsapp small" onclick="shareOnWhatsApp()">ğŸ“² ÙˆØ§ØªØ³Ø§Ø¨</button>
      <button class="secondary small" onclick="saveAsImage()">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø©</button>
      <button class="gold small" onclick="openContract()" id="contractBtn" style="display:none;">ğŸ“ Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯</button>
      <button class="secondary small" onclick="resetCalculator()">ğŸ”„ Ø­Ø³Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
      <button class="secondary small" onclick="goHome()">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
  </div>

  <!-- ==================== ØµÙØ­Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ ==================== -->
  <div id="comingSoonPage" class="page">
    <div class="card fade-in">
      <div style="font-size:48px; margin-bottom:16px;">ğŸš§</div>
      <h2 style="margin:0 0 12px; font-size:20px; color:#111827;" id="comingSoonTitle">Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡</h2>
      <p style="font-size:14px; color:#6b7280; line-height:1.7;" id="comingSoonText">
        Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹.
      </p>
      <button class="secondary" onclick="goBackToFinanceType()" style="margin-top:16px;">
        ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„
      </button>
    </div>
  </div>

  <!-- ==================== ØµÙØ­Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ==================== -->
  <div id="adminLoginPage" class="page">
    <div class="card fade-in">
      <h2 style="margin:0 0 16px; font-size:20px;">ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
      <p style="font-size:13px; color:#b91c1c; text-align:right; margin-bottom:16px;">
        âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù…Ø®ØµØµ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙÙ‚Ø·. Ø£ÙŠ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ù‡Ø§ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡Ø§.
      </p>
      <input id="adminPin" type="password" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„" />
      <div style="margin-top:12px; display:flex; gap:10px; justify-content:center;">
        <button class="primary small" onclick="handleAdminLogin()">Ø¯Ø®ÙˆÙ„</button>
        <button class="secondary small" onclick="goHome()">Ø¥Ù„ØºØ§Ø¡</button>
      </div>
      <div id="adminLoginError" class="alert-error" style="display:none;">
        Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­!
      </div>
    </div>
  </div>

  <!-- ==================== Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ==================== -->
  <div id="adminHubPage" class="page">
    <div class="card fade-in">
      <h2 style="margin:0 0 16px; font-size:20px;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <button class="secondary small" onclick="showAdminPage('banks')">ğŸ¦ Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ù†Ø³Ø¨</button>
        <button class="secondary small" onclick="showAdminPage('jobs')">ğŸ’¼ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</button>
        <button class="secondary small" onclick="showAdminPage('products')">ğŸ“¦ Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„</button>
        <button class="secondary small" onclick="showAdminPage('results')">ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
        <button class="secondary small" onclick="showAdminPage('ads')">ğŸ“¢ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
        <button class="secondary small" onclick="showAdminPage('offers')">ğŸ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ©</button>
        <button class="secondary small" onclick="showAdminPage('reviews')">â­ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</button>
        <button class="secondary small" onclick="showAdminPage('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        <button class="secondary small" onclick="showAdminPage('carLeasing')">ğŸš— Ø§Ù„ØªØ£Ø¬ÙŠØ±ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª</button>
        <button class="secondary small" onclick="showAdminPage('docs')">ğŸ“„ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</button>
        <button class="secondary small" onclick="showAdminPage('loginLogs')">ğŸ”’ Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        <button class="secondary small" onclick="togglePlatformLock()" id="lockBtn">ğŸ”’ Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©</button>
      </div>
      <button class="primary small" onclick="goHome()" style="margin-top:16px; width:100%;">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
  </div>

</div>

<!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø®ÙÙŠØ© -->
<div class="admin-icon-hidden" onclick="showAdminLogin()" id="adminIconHidden">â–«ï¸</div>

<footer>
  <div id="dateTimeDisplay"></div>
  <div style="margin-top:8px;">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© - Ù…Ù†ØµØ© FINO Ù„Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ</div>
</footer>

<!-- ==================== Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª ==================== -->

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ù†ÙˆÙƒ -->
<div class="modal" id="banksModal">
  <div class="modal-content" style="max-width:800px;">
    <div class="modal-header">
      <span class="modal-title">ğŸ¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ù†Ø³Ø¨</span>
      <button class="modal-close" onclick="closeModal('banksModal')">&times;</button>
    </div>
    <div id="banksContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù -->
<div class="modal" id="jobsModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">ğŸ’¼ Ø¥Ø¯Ø§Ø±Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</span>
      <button class="modal-close" onclick="closeModal('jobsModal')">&times;</button>
    </div>
    <div id="jobsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„ -->
<div class="modal" id="productsModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„</span>
      <button class="modal-close" onclick="closeModal('productsModal')">&times;</button>
    </div>
    <div id="productsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ -->
<div class="modal" id="resultsModal">
  <div class="modal-content" style="max-width:800px;">
    <div class="modal-header">
      <span class="modal-title">ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</span>
      <button class="modal-close" onclick="closeModal('resultsModal')">&times;</button>
    </div>
    <div id="resultsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª -->
<div class="modal" id="adsModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">ğŸ“¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</span>
      <button class="modal-close" onclick="closeModal('adsModal')">&times;</button>
    </div>
    <div id="adsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ© -->
<div class="modal" id="offersModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">ğŸ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ©</span>
      <button class="modal-close" onclick="closeModal('offersModal')">&times;</button>
    </div>
    <div id="offersContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª -->
<div class="modal" id="reviewsModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">â­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</span>
      <button class="modal-close" onclick="closeModal('reviewsModal')">&times;</button>
    </div>
    <div id="reviewsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
<div class="modal" id="settingsModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</span>
      <button class="modal-close" onclick="closeModal('settingsModal')">&times;</button>
    </div>
    <div id="settingsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ£Ø¬ÙŠØ±ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª -->
<div class="modal" id="carLeasingModal">
  <div class="modal-content" style="max-width:800px;">
    <div class="modal-header">
      <span class="modal-title">ğŸš— Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØªØ£Ø¬ÙŠØ±ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª</span>
      <button class="modal-close" onclick="closeModal('carLeasingModal')">&times;</button>
    </div>
    <div id="carLeasingContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ -->
<div class="modal" id="docsModal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">ğŸ“„ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</span>
      <button class="modal-close" onclick="closeModal('docsModal')">&times;</button>
    </div>
    <div id="docsContent"></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div class="modal" id="loginLogsModal">
  <div class="modal-content" style="max-width:700px;">
    <div class="modal-header">
      <span class="modal-title">ğŸ”’ Ø³Ø¬Ù„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
      <button class="modal-close" onclick="closeModal('loginLogsModal')">&times;</button>
    </div>
    <div id="loginLogsContent"></div>
  </div>
</div>


<script>
// ==================== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ====================
const ADMIN_PIN = '11qq11qQ@';
let currentPage = 'landing';
let answers = {};
let currentStep = 0;
let totalSteps = 0;

// ==================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ®Ø²ÙŠÙ† ====================
const STORAGE_KEYS = {
  banks: 'fino_banks',
  jobs: 'fino_jobs',
  products: 'fino_products',
  results: 'fino_results',
  ads: 'fino_ads',
  offers: 'fino_offers',
  reviews: 'fino_reviews',
  settings: 'fino_settings',
  cars: 'fino_cars',
  docs: 'fino_docs',
  loginLogs: 'fino_login_logs',
  platformLock: 'fino_platform_lock'
};

// ==================== Ø§Ù„ÙƒÙ„Ø§Ù… Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠ Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ====================
const marketingPhrases = {
  greetings: [
    'Ø­ÙŠØ§Ùƒ Ø§Ù„Ù„Ù‡ ÙŠØ§ {name}! ğŸ‘‹',
    'Ù‡Ù„Ø§ ÙˆØ§Ù„Ù„Ù‡ ÙŠØ§ {name}! ğŸŒŸ',
    'Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ ÙŠØ§ {name}! ğŸ’«',
    'Ù…Ø±Ø­Ø¨Ø§ ÙŠØ§ {name}ØŒ Ù†ÙˆØ±Øª! âœ¨',
    'ÙŠØ§ Ù‡Ù„Ø§ ÙŠØ§ {name}! ğŸ‰',
    'Ø§Ù„Ù„Ù‡ ÙŠØ­ÙŠÙŠÙƒ ÙŠØ§ {name}! ğŸ™',
    'ØªØ´Ø±ÙÙ†Ø§ ÙŠØ§ {name}! ğŸ’',
    'Ù…Ù†ÙˆØ± ÙŠØ§ {name}! ğŸŒ™',
    'ÙŠØ§ Ù…Ø±Ø­Ø¨Ø§ ÙŠØ§ {name}! ğŸ¤',
    'Ù‡Ù„Ø§ ÙˆØºÙ„Ø§ ÙŠØ§ {name}! â¤ï¸'
  ],
  closings: [
    'Ø§Ù„Ù„Ù‡ ÙŠÙˆÙÙ‚Ùƒ ÙŠØ§ {name}! ğŸ¤²',
    'Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙŠØ§ {name}! ğŸ€',
    'Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø­ÙŠØ§Ø© Ø³Ø¹ÙŠØ¯Ø©! ğŸ ',
    'Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ ØªÙ…ÙˆÙŠÙ„Ùƒ ÙŠØªÙ… Ø¹Ù„Ù‰ Ø®ÙŠØ±! ğŸ’°',
    'Ø§Ù„Ù„Ù‡ ÙŠØ³Ù‡Ù„ Ø£Ù…ÙˆØ±Ùƒ ÙŠØ§ {name}! ğŸŒŸ',
    'Ù…ÙˆÙÙ‚ ÙŠØ§ {name}! âœ¨',
    'Ù†Ø³Ø¹Ø¯ Ø¨Ø®Ø¯Ù…ØªÙƒ Ø¯Ø§Ø¦Ù…Ø§Ù‹! ğŸ¯',
    'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±! ğŸ“',
    'Ø§Ù„Ù„Ù‡ ÙŠØ¨Ø§Ø±Ùƒ Ù„Ùƒ ÙŠØ§ {name}! ğŸ¤²',
    'Ù†Ù†ØªØ¸Ø±Ùƒ Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙŠØ§ {name}! ğŸ’«'
  ],
  funnyResponses: [
    'Ù„Ø§ ÙŠØ§ {name} Ø­Ø· Ø§Ù„Ø±Ù‚Ù… Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ ÙˆÙ„Ø§ Ù…Ø§ ØªØ¹Ø±Ù ğŸ¤£',
    'ÙŠØ§ {name} Ø±ÙƒØ² Ù…Ø¹ÙŠ Ø´ÙˆÙŠ ğŸ˜„',
    'Ù‡Ù‡Ù‡Ù‡ ÙŠØ§ {name} Ø®Ù„Ù†Ø§ Ù†ÙƒÙ…Ù„ ğŸ˜Š'
  ],
  goodNews: [
    'Ù…Ø§Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙƒ ÙŠØ§ {name}! Ø§Ù„Ø¹Ø±Ø¶ Ø¬Ø§ÙŠÙƒ Ø­Ù„Ùˆ ğŸ‰',
    'ØªØ¨Ø§Ø±Ùƒ Ø§Ù„Ø±Ø­Ù…Ù† ÙŠØ§ {name}! Ù†Ø³Ø¨Ø© Ù…Ù…ØªØ§Ø²Ø© ğŸ’ª',
    'Ø§Ù„Ù„Ù‡ ÙŠØ¨Ø§Ø±Ùƒ ÙŠØ§ {name}! ØªÙ…ÙˆÙŠÙ„Ùƒ Ø·Ø§Ù„Ø¹ ØªÙ…Ø§Ù… ğŸ‘'
  ],
  advice: [
    'Ø§Ø·Ù„Ø¨ Ø®Ø·Ø§Ø¨ Ù„Ø§ Ù…Ø§Ù†Ø¹Ø© ÙŠØ§ {name} ÙˆØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ù†Ø¸Ø¨Ø·Ùƒ Ø¨Ø§Ù„Ø¹Ø±Ø¶ ğŸ˜‰',
    'ÙŠØ§ {name} Ù„Ùˆ ØªØ¨ÙŠ Ù†Ø³Ø§Ø¹Ø¯Ùƒ Ø¨Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ ğŸ“',
    'Ù†ØµÙŠØ­Ø© ÙŠØ§ {name}: Ù‚Ø§Ø±Ù† Ø¨ÙŠÙ† Ø§Ù„Ø¨Ù†ÙˆÙƒ Ù‚Ø¨Ù„ Ù…Ø§ ØªÙ‚Ø±Ø± ğŸ’¡'
  ]
};

// ==================== Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ====================
function getDefaultJobs() {
  return [
    { id: 1, name: 'Ø¹Ø³ÙƒØ±ÙŠ', enabled: true },
    { id: 2, name: 'Ù…Ø¯Ù†ÙŠ (Ù‚Ø·Ø§Ø¹ Ø­ÙƒÙˆÙ…ÙŠ)', enabled: true },
    { id: 3, name: 'Ø®Ø§Øµ (Ø´Ø¨Ù‡ Ø­ÙƒÙˆÙ…ÙŠ)', enabled: true },
    { id: 4, name: 'Ø®Ø§Øµ (Ø´Ø±ÙƒØ© Ù…Ø¹ØªÙ…Ø¯Ø©)', enabled: true },
    { id: 5, name: 'Ø®Ø§Øµ (Ø´Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¹ØªÙ…Ø¯Ø©)', enabled: true },
    { id: 6, name: 'Ù…ØªÙ‚Ø§Ø¹Ø¯', enabled: true }
  ];
}

// ==================== Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ====================
function getDefaultProducts() {
  return [
    { id: 1, name: 'ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ', enabled: true, message: '' },
    { id: 2, name: 'ØªÙ…ÙˆÙŠÙ„ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ', enabled: true, message: '' },
    { id: 3, name: 'ØªÙ…ÙˆÙŠÙ„ ØªØ£Ø¬ÙŠØ±ÙŠ', enabled: true, message: '' },
    { id: 4, name: 'ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ', enabled: true, message: '' },
    { id: 5, name: 'Ø´Ø±Ø§Ø¡ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ', enabled: true, message: '' },
    { id: 6, name: 'Ø´Ø±Ø§Ø¡ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ', enabled: false, message: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡' },
    { id: 7, name: 'ØªÙ…ÙˆÙŠÙ„ ØªØ£Ø¬ÙŠØ±ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª', enabled: true, message: '' },
    { id: 8, name: 'Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†', enabled: false, message: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡' }
  ];
}

// ==================== Ø§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ====================
function getDefaultBanks() {
  return [
    { id: 1, name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', logo: 'ğŸ¦', enabled: true },
    { id: 2, name: 'Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ', logo: 'ğŸ¦', enabled: true },
    { id: 3, name: 'Ø¨Ù†Ùƒ Ø§Ù„Ø±ÙŠØ§Ø¶', logo: 'ğŸ¦', enabled: true },
    { id: 4, name: 'Ø¨Ù†Ùƒ Ø³Ø§Ø¨', logo: 'ğŸ¦', enabled: true },
    { id: 5, name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„ÙˆØ·Ù†ÙŠ', logo: 'ğŸ¦', enabled: true },
    { id: 6, name: 'Ù…ØµØ±Ù Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡', logo: 'ğŸ¦', enabled: true },
    { id: 7, name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ', logo: 'ğŸ¦', enabled: true },
    { id: 8, name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±', logo: 'ğŸ¦', enabled: true },
    { id: 9, name: 'Ø¨Ù†Ùƒ Ø§Ù„Ø¨Ù„Ø§Ø¯', logo: 'ğŸ¦', enabled: true },
    { id: 10, name: 'Ø¨Ù†Ùƒ Ø§Ù„Ø¬Ø²ÙŠØ±Ø©', logo: 'ğŸ¦', enabled: true }
  ];
}

// ==================== Ù…Ø§Ø±ÙƒØ§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ====================
function getDefaultCars() {
  return [
    { id: 1, brand: 'ØªÙˆÙŠÙˆØªØ§', models: ['ÙƒØ§Ù…Ø±ÙŠ', 'ÙƒÙˆØ±ÙˆÙ„Ø§', 'Ù„Ø§Ù†Ø¯ÙƒØ±ÙˆØ²Ø±', 'Ù‡Ø§ÙŠÙ„ÙƒØ³', 'Ø±Ø§Ù ÙÙˆØ±', 'ÙÙˆØ±ØªØ´Ù†Ø±', 'ÙŠØ§Ø±Ø³', 'Ø£ÙØ§Ù„ÙˆÙ†'] },
    { id: 2, brand: 'Ù‡ÙŠÙˆÙ†Ø¯Ø§ÙŠ', models: ['Ø³ÙˆÙ†Ø§ØªØ§', 'Ø¥Ù„Ù†ØªØ±Ø§', 'Ø£ÙƒØ³Ù†Øª', 'ØªÙˆØ³Ø§Ù†', 'Ø³Ø§Ù†ØªØ§ÙÙŠ', 'ÙƒÙˆÙ†Ø§'] },
    { id: 3, brand: 'ÙƒÙŠØ§', models: ['Ø³ÙŠØ±Ø§ØªÙˆ', 'Ø£ÙˆØ¨ØªÙŠÙ…Ø§', 'Ø³Ø¨ÙˆØ±ØªØ§Ø¬', 'Ø³ÙˆØ±ÙŠÙ†ØªÙˆ', 'Ø±ÙŠÙˆ', 'ÙƒØ§Ø±Ù†ÙŠÙØ§Ù„'] },
    { id: 4, brand: 'Ù†ÙŠØ³Ø§Ù†', models: ['Ø£Ù„ØªÙŠÙ…Ø§', 'Ø³Ù†ØªØ±Ø§', 'Ø¨Ø§ØªØ±ÙˆÙ„', 'Ø¥ÙƒØ³ ØªØ±ÙŠÙ„', 'ØµÙ†ÙŠ', 'Ù…ÙƒØ³ÙŠÙ…Ø§'] },
    { id: 5, brand: 'Ø´ÙŠÙØ±ÙˆÙ„ÙŠÙ‡', models: ['Ù…Ø§Ù„ÙŠØ¨Ùˆ', 'ÙƒØ§Ø¨ØªÙŠÙØ§', 'ØªØ§Ù‡Ùˆ', 'Ø³ÙˆØ¨Ø±Ø¨Ø§Ù†', 'ØªØ±Ø§ÙÙŠØ±Ø³'] },
    { id: 6, brand: 'ÙÙˆØ±Ø¯', models: ['ØªÙˆØ±ÙˆØ³', 'Ø¥ÙƒØ³Ø¨Ù„ÙˆØ±Ø±', 'Ø¥ÙƒØ³Ø¨ÙŠØ¯ÙŠØ´Ù†', 'ÙÙŠÙˆØ¬Ù†', 'Ø¥ÙŠØ¯Ø¬'] },
    { id: 7, brand: 'Ø¬ÙŠ Ø¥Ù… Ø³ÙŠ', models: ['ÙŠÙˆÙƒÙ†', 'Ø³ÙŠÙŠØ±Ø§', 'ØªÙŠØ±ÙŠÙ†', 'Ø£ÙƒØ§Ø¯ÙŠØ§'] },
    { id: 8, brand: 'Ù…Ø±Ø³ÙŠØ¯Ø³', models: ['Ø§Ù„ÙØ¦Ø© C', 'Ø§Ù„ÙØ¦Ø© E', 'Ø§Ù„ÙØ¦Ø© S', 'GLE', 'GLC'] },
    { id: 9, brand: 'Ø¨ÙŠ Ø¥Ù… Ø¯Ø¨Ù„ÙŠÙˆ', models: ['Ø§Ù„ÙØ¦Ø© 3', 'Ø§Ù„ÙØ¦Ø© 5', 'Ø§Ù„ÙØ¦Ø© 7', 'X5', 'X3'] },
    { id: 10, brand: 'Ù„ÙƒØ²Ø³', models: ['ES', 'LS', 'RX', 'LX', 'NX'] },
    { id: 11, brand: 'Ù‡ÙˆÙ†Ø¯Ø§', models: ['Ø£ÙƒÙˆØ±Ø¯', 'Ø³ÙŠÙÙŠÙƒ', 'CR-V', 'Ø¨Ø§ÙŠÙ„ÙˆØª'] },
    { id: 12, brand: 'Ù…Ø§Ø²Ø¯Ø§', models: ['Ù…Ø§Ø²Ø¯Ø§ 3', 'Ù…Ø§Ø²Ø¯Ø§ 6', 'CX-5', 'CX-9'] },
    { id: 13, brand: 'Ø¬ÙŠØ¨', models: ['Ø¬Ø±Ø§Ù†Ø¯ Ø´ÙŠØ±ÙˆÙƒÙŠ', 'Ø±Ø§Ù†Ø¬Ù„Ø±', 'Ø´ÙŠØ±ÙˆÙƒÙŠ', 'ÙƒÙˆÙ…Ø¨Ø§Ø³'] },
    { id: 14, brand: 'Ø¯ÙˆØ¯Ø¬', models: ['ØªØ´Ø§Ø±Ø¬Ø±', 'Ø¯ÙˆØ±Ø§Ù†Ø¬Ùˆ', 'ØªØ´Ø§Ù„Ù†Ø¬Ø±'] },
    { id: 15, brand: 'Ø¬ÙŠÙ„ÙŠ', models: ['Ø¥Ù…Ø¬Ø±Ø§Ù†Ø¯', 'ÙƒÙˆÙ„Ø±Ø§ÙŠ', 'Ø£Ø²ÙƒØ§Ø±Ø§'] },
    { id: 16, brand: 'Ø¥Ù… Ø¬ÙŠ', models: ['MG5', 'MG6', 'ZS', 'HS', 'RX5'] },
    { id: 17, brand: 'Ø´Ø§Ù†Ø¬Ø§Ù†', models: ['Ø¥ÙŠØ¯Ùˆ', 'CS35', 'CS55', 'CS75', 'CS95'] },
    { id: 18, brand: 'Ù‡Ø§ÙØ§Ù„', models: ['H6', 'Ø¬ÙˆÙ„ÙŠØ§Ù†', 'Ø¯Ø§Ø±ÙƒÙˆ'] }
  ];
}

// ==================== Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ====================
function getDefaultSettings() {
  return {
    whatsappNumber: '966500000000',
    contractLink: '',
    contractButtonText: 'Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯',
    contractButtonVisible: true,
    marketingText: 'Ù†Ù†Ø¬Ø² ØªÙ…ÙˆÙŠÙ„Ùƒ Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§',
    marketingVisible: true,
    showReviewsOnHome: false,
    maxAge: 60,
    ageCalculation: 'hijri' // hijri or gregorian
  };
}

// ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ®Ø²ÙŠÙ† ====================
function loadData(key, defaultValue) {
  try {
    const data = localStorage.getItem(key);
    return data ? JSON.parse(data) : defaultValue;
  } catch(e) {
    return defaultValue;
  }
}

function saveData(key, data) {
  localStorage.setItem(key, JSON.stringify(data));
}

// ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ ====================
function getHijriDate() {
  try {
    const fmt = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura', {
      year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'
    });
    return fmt.format(new Date());
  } catch(e) {
    return '';
  }
}

function getHijriParts() {
  try {
    const fmt = new Intl.DateTimeFormat('en-US-u-ca-islamic-umalqura', {
      year: 'numeric', month: 'numeric', day: 'numeric'
    });
    const parts = fmt.formatToParts(new Date());
    return {
      y: parseInt(parts.find(p => p.type === 'year')?.value || '1446'),
      m: parseInt(parts.find(p => p.type === 'month')?.value || '1'),
      d: parseInt(parts.find(p => p.type === 'day')?.value || '1')
    };
  } catch(e) {
    return { y: 1446, m: 1, d: 1 };
  }
}

function getGregorianDate() {
  return new Date().toLocaleDateString('ar-SA', {
    year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'
  });
}

function monthsDiff(fromY, fromM, toY, toM) {
  return (toY * 12 + toM) - (fromY * 12 + fromM);
}

// ==================== Ø¯ÙˆØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù„Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ====================
function numberToArabicWords(num) {
  if (num === 0) return 'ØµÙØ± Ø±ÙŠØ§Ù„';
  
  const ones = ['', 'ÙˆØ§Ø­Ø¯', 'Ø§Ø«Ù†Ø§Ù†', 'Ø«Ù„Ø§Ø«Ø©', 'Ø£Ø±Ø¨Ø¹Ø©', 'Ø®Ù…Ø³Ø©', 'Ø³ØªØ©', 'Ø³Ø¨Ø¹Ø©', 'Ø«Ù…Ø§Ù†ÙŠØ©', 'ØªØ³Ø¹Ø©'];
  const tens = ['', 'Ø¹Ø´Ø±Ø©', 'Ø¹Ø´Ø±ÙˆÙ†', 'Ø«Ù„Ø§Ø«ÙˆÙ†', 'Ø£Ø±Ø¨Ø¹ÙˆÙ†', 'Ø®Ù…Ø³ÙˆÙ†', 'Ø³ØªÙˆÙ†', 'Ø³Ø¨Ø¹ÙˆÙ†', 'Ø«Ù…Ø§Ù†ÙˆÙ†', 'ØªØ³Ø¹ÙˆÙ†'];
  const teens = ['Ø¹Ø´Ø±Ø©', 'Ø£Ø­Ø¯ Ø¹Ø´Ø±', 'Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±', 'Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±', 'Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±', 'Ø®Ù…Ø³Ø© Ø¹Ø´Ø±', 'Ø³ØªØ© Ø¹Ø´Ø±', 'Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±', 'Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±', 'ØªØ³Ø¹Ø© Ø¹Ø´Ø±'];
  const hundreds = ['', 'Ù…Ø§Ø¦Ø©', 'Ù…Ø§Ø¦ØªØ§Ù†', 'Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©', 'Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©', 'Ø®Ù…Ø³Ù…Ø§Ø¦Ø©', 'Ø³ØªÙ…Ø§Ø¦Ø©', 'Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©', 'Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©', 'ØªØ³Ø¹Ù…Ø§Ø¦Ø©'];
  
  let n = Math.floor(num);
  let parts = [];
  
  // Ø§Ù„Ù…Ù„Ø§ÙŠÙŠÙ†
  if (n >= 1000000) {
    const millions = Math.floor(n / 1000000);
    if (millions === 1) parts.push('Ù…Ù„ÙŠÙˆÙ†');
    else if (millions === 2) parts.push('Ù…Ù„ÙŠÙˆÙ†Ø§Ù†');
    else if (millions >= 3 && millions <= 10) parts.push(ones[millions] + ' Ù…Ù„Ø§ÙŠÙŠÙ†');
    else parts.push(millions + ' Ù…Ù„ÙŠÙˆÙ†');
    n %= 1000000;
  }
  
  // Ø§Ù„Ø¢Ù„Ø§Ù
  if (n >= 1000) {
    const thousands = Math.floor(n / 1000);
    if (thousands === 1) parts.push('Ø£Ù„Ù');
    else if (thousands === 2) parts.push('Ø£Ù„ÙØ§Ù†');
    else if (thousands >= 3 && thousands <= 10) parts.push(ones[thousands] + ' Ø¢Ù„Ø§Ù');
    else if (thousands > 10) parts.push(thousands + ' Ø£Ù„Ù');
    n %= 1000;
  }
  
  // Ø§Ù„Ù…Ø¦Ø§Øª
  if (n >= 100) {
    parts.push(hundreds[Math.floor(n / 100)]);
    n %= 100;
  }
  
  // Ø§Ù„Ø¹Ø´Ø±Ø§Øª ÙˆØ§Ù„Ø¢Ø­Ø§Ø¯
  if (n >= 20) {
    const t = Math.floor(n / 10);
    const o = n % 10;
    if (o > 0) {
      parts.push(ones[o] + ' Ùˆ' + tens[t]);
    } else {
      parts.push(tens[t]);
    }
  } else if (n >= 10) {
    parts.push(teens[n - 10]);
  } else if (n > 0) {
    parts.push(ones[n]);
  }
  
  return parts.join(' Ùˆ') + ' Ø±ÙŠØ§Ù„';
}

// ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ====================
function formatMoney(num) {
  return Number(num || 0).toLocaleString('ar-SA') + ' Ø±ÙŠØ§Ù„';
}

function formatMonths(m) {
  const years = Math.floor(m / 12);
  const months = m % 12;
  let result = m + ' Ø´Ù‡Ø±';
  
  if (years > 0 || months > 0) {
    result += ' (';
    if (years === 1) result += 'Ø³Ù†Ø©';
    else if (years === 2) result += 'Ø³Ù†ØªØ§Ù†';
    else if (years >= 3 && years <= 10) result += years + ' Ø³Ù†ÙˆØ§Øª';
    else if (years > 10) result += years + ' Ø³Ù†Ø©';
    
    if (years > 0 && months > 0) result += ' Ùˆ';
    
    if (months === 1) result += 'Ø´Ù‡Ø±';
    else if (months === 2) result += 'Ø´Ù‡Ø±ÙŠÙ†';
    else if (months >= 3 && months <= 10) result += months + ' Ø£Ø´Ù‡Ø±';
    else if (months > 10) result += months + ' Ø´Ù‡Ø±';
    
    result += ')';
  }
  
  return result;
}

function escapeHtml(str) {
  return String(str || '')
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

function getRandomPhrase(type, name) {
  const phrases = marketingPhrases[type] || [];
  if (phrases.length === 0) return '';
  const phrase = phrases[Math.floor(Math.random() * phrases.length)];
  return phrase.replace(/{name}/g, name || 'Ø¹Ø²ÙŠØ²ÙŠ');
}

// ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ†Ù‚Ù„ ====================
function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  const page = document.getElementById(pageId + 'Page');
  if (page) {
    page.classList.add('active');
    currentPage = pageId;
  }
  
  // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø©
  const adminIcon = document.getElementById('adminIconHidden');
  if (adminIcon) {
    adminIcon.style.display = (pageId === 'landing' || pageId === 'result') ? 'block' : 'none';
  }
}

function goHome() {
  showPage('landing');
}

function showAdminLogin() {
  document.getElementById('adminPin').value = '';
  document.getElementById('adminLoginError').style.display = 'none';
  showPage('adminLogin');
}

function closeModal(modalId) {
  document.getElementById(modalId).classList.remove('active');
}

function openModal(modalId) {
  document.getElementById(modalId).classList.add('active');
}

// ==================== Ø³Ù† Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ ====================
const militaryRetirementAges = {
  'Ø¬Ù†Ø¯ÙŠ': 44, 'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„': 44, 'Ø¹Ø±ÙŠÙ': 46, 'ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨': 48,
  'Ø±Ù‚ÙŠØ¨': 50, 'Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„': 50, 'Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡': 52,
  'Ù…Ù„Ø§Ø²Ù…': 44, 'Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„': 44, 'Ù†Ù‚ÙŠØ¨': 48, 'Ø±Ø§Ø¦Ø¯': 50,
  'Ù…Ù‚Ø¯Ù…': 52, 'Ø¹Ù‚ÙŠØ¯': 54, 'Ø¹Ù…ÙŠØ¯': 56, 'Ù„ÙˆØ§Ø¡': 58
};

function getRetirementAge(rank) {
  return militaryRetirementAges[rank] || 60;
}

// ==================== Ø­Ø³Ø§Ø¨ Ø±Ø§ØªØ¨ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ ====================
function calculateRetirementSalary(currentSalary, yearsOfService, jobType) {
  // Ù…Ø¹Ø§Ø¯Ù„Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØ©: Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ã— Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¯Ù…Ø© Ã— 2.5%
  // Ù…Ø¹ Ø­Ø¯ Ø£Ù‚ØµÙ‰ 80% Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨
  const percentage = Math.min(yearsOfService * 2.5, 80) / 100;
  return Math.round(currentSalary * percentage);
}

</script>

<script>
// ==================== Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ====================
function getQuestions() {
  const jobs = loadData(STORAGE_KEYS.jobs, getDefaultJobs()).filter(j => j.enabled);
  const products = loadData(STORAGE_KEYS.products, getDefaultProducts()).filter(p => p.enabled);
  const banks = loadData(STORAGE_KEYS.banks, getDefaultBanks()).filter(b => b.enabled);
  
  return [
    {
      id: 'clientName',
      label: 'Ø¹Ø±ÙÙ†Ø§ Ø¨Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ… ğŸ˜Š',
      type: 'text',
      placeholder: 'Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§',
      required: true,
      autoNext: false
    },
    {
      id: 'birthDate',
      label: 'ØªØ§Ø±ÙŠØ® Ù…ÙŠÙ„Ø§Ø¯Ùƒ Ø§Ù„Ù‡Ø¬Ø±ÙŠ ğŸ“…',
      type: 'date-hijri',
      required: true,
      autoNext: true
    },
    {
      id: 'jobType',
      label: 'Ù†ÙˆØ¹ ÙˆØ¸ÙŠÙØªÙƒØŸ ğŸ’¼',
      type: 'options',
      options: jobs.map(j => j.name),
      required: true,
      autoNext: true
    },
    {
      id: 'militaryRank',
      label: 'Ø±ØªØ¨ØªÙƒ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©ØŸ ğŸ–ï¸',
      type: 'options',
      options: Object.keys(militaryRetirementAges),
      required: true,
      autoNext: true,
      show: (a) => a.jobType === 'Ø¹Ø³ÙƒØ±ÙŠ'
    },
    {
      id: 'financeType',
      label: 'Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ù„ÙŠ ØªØ¨ÙŠÙ‡ØŸ ğŸ’°',
      type: 'options',
      options: products.map(p => p.name),
      required: true,
      autoNext: true
    },
    {
      id: 'mortgageType',
      label: 'Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØŸ ğŸ ',
      type: 'options',
      options: ['ÙˆØ­Ø¯Ø© Ø¬Ø§Ù‡Ø²Ø© Ù…Ù† Ø§Ù„Ø³ÙˆÙ‚', 'Ø¨Ù†Ø§Ø¡ Ø°Ø§ØªÙŠ', 'Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø®Ø§Ø±Ø·Ø©', 'ØªØ­Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡', 'Ø£Ø±Ø¶ ÙˆÙ‚Ø±Ø¶', 'Ø£Ø±Ø¶ Ø³ÙƒÙ†ÙŠØ©', 'Ø±Ù‡Ù†'],
      required: true,
      autoNext: true,
      show: (a) => a.financeType === 'ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'
    },
    {
      id: 'isSupported',
      label: 'Ù‡Ù„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ù…Ø¯Ø¹ÙˆÙ… Ù…Ù† Ø³ÙƒÙ†ÙŠØŸ ğŸ¡',
      type: 'options',
      options: ['Ù…Ø¯Ø¹ÙˆÙ…', 'ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'],
      required: true,
      autoNext: true,
      show: (a) => a.financeType === 'ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ' && ['ÙˆØ­Ø¯Ø© Ø¬Ø§Ù‡Ø²Ø© Ù…Ù† Ø§Ù„Ø³ÙˆÙ‚', 'Ø¨Ù†Ø§Ø¡ Ø°Ø§ØªÙŠ', 'Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø®Ø§Ø±Ø·Ø©', 'ØªØ­Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡', 'Ø£Ø±Ø¶ ÙˆÙ‚Ø±Ø¶'].includes(a.mortgageType)
    },
    {
      id: 'currentSalaryBank',
      label: 'Ø±Ø§ØªØ¨Ùƒ Ø­Ø§Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø£ÙŠ Ø¨Ù†ÙƒØŸ ğŸ¦',
      type: 'options',
      options: ['ØºÙŠØ± Ù…Ø­ÙˆÙ„', ...banks.map(b => b.name)],
      required: true,
      autoNext: true
    },
    {
      id: 'salary',
      label: 'ÙƒÙ… Ø±Ø§ØªØ¨Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„ØµØ§ÙÙŠØŸ ğŸ’µ',
      type: 'number',
      placeholder: 'Ù…Ø«Ø§Ù„: 12000',
      required: true,
      autoNext: false
    },
    {
      id: 'retirementSalary',
      label: 'ÙƒÙ… Ø±Ø§ØªØ¨Ùƒ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠØŸ ğŸ’°',
      type: 'number',
      placeholder: 'Ù…Ø«Ø§Ù„: 8000',
      required: true,
      autoNext: false,
      show: (a) => a.jobType === 'Ù…ØªÙ‚Ø§Ø¹Ø¯'
    },
    {
      id: 'extendAfterRetirement',
      label: 'ØªØ¨ÙŠ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙŠÙ…ØªØ¯ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ø¹Ù…Ø± 60ØŸ ğŸ“ˆ',
      type: 'options',
      options: ['Ù†Ø¹Ù…', 'Ù„Ø§'],
      required: true,
      autoNext: true,
      show: (a) => {
        if (a.jobType !== 'Ø¹Ø³ÙƒØ±ÙŠ') return false;
        const rank = a.militaryRank;
        if (!rank) return false;
        const retAge = getRetirementAge(rank);
        const birthYear = parseInt(a.birthYear || '0');
        const now = getHijriParts();
        const age = now.y - birthYear;
        const yearsToRetirement = retAge - age;
        return yearsToRetirement > 0 && yearsToRetirement < 25 && age < 60;
      }
    },
    {
      id: 'months',
      label: 'Ø¹Ù„Ù‰ ÙƒÙ… Ø´Ù‡Ø± ØªØ¨ÙŠ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ØŸ ğŸ“†',
      type: 'select-months',
      required: true,
      autoNext: true
    },
    {
      id: 'calcMode',
      label: 'ÙƒÙŠÙ ØªØ¨ÙŠ Ù†Ø­Ø³Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø©ØŸ ğŸ¯',
      type: 'options',
      options: ['Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Ø³Ø¨Ø© Ø¨Ù†ÙØ³ÙŠ', 'Ø±Ø´Ø­ Ù„ÙŠ Ø¨Ù†Ùƒ Ù…Ù†Ø§Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹'],
      required: true,
      autoNext: true
    },
    {
      id: 'profitMargin',
      label: 'Ù†Ø³Ø¨Ø© Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)ØŸ ğŸ“Š',
      type: 'number',
      placeholder: 'Ù…Ø«Ø§Ù„: 4.5',
      required: true,
      autoNext: false,
      show: (a) => a.calcMode === 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Ø³Ø¨Ø© Ø¨Ù†ÙØ³ÙŠ'
    },
    {
      id: 'buyoutAmount',
      label: 'ÙƒÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„ØªØ³Ø¯ÙŠØ¯ØŸ ğŸ’³',
      type: 'number',
      placeholder: 'Ù…Ø«Ø§Ù„: 50000',
      required: true,
      autoNext: false,
      show: (a) => a.financeType === 'Ø´Ø±Ø§Ø¡ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'
    },
    {
      id: 'hasCommitments',
      label: 'Ø¹Ù†Ø¯Ùƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª (Ø£Ù‚Ø³Ø§Ø·)ØŸ ğŸ“‹',
      type: 'options',
      options: ['Ù†Ø¹Ù…', 'Ù„Ø§'],
      required: true,
      autoNext: true
    },
    {
      id: 'commitmentAmount',
      label: 'ÙƒÙ… Ù…Ø¬Ù…ÙˆØ¹ Ø£Ù‚Ø³Ø§Ø·Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©ØŸ ğŸ’¸',
      type: 'number',
      placeholder: 'Ù…Ø«Ø§Ù„: 2000',
      required: true,
      autoNext: false,
      show: (a) => a.hasCommitments === 'Ù†Ø¹Ù…'
    },
    {
      id: 'commitmentMonths',
      label: 'ÙƒÙ… Ø´Ù‡Ø± Ù…ØªØ¨Ù‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§ØªØŸ ğŸ“…',
      type: 'number',
      placeholder: 'Ù…Ø«Ø§Ù„: 24',
      required: true,
      autoNext: false,
      show: (a) => a.hasCommitments === 'Ù†Ø¹Ù…'
    },
    {
      id: 'region',
      label: 'ÙÙŠ Ø£ÙŠ Ù…Ù†Ø·Ù‚Ø© ØªØ³ÙƒÙ†ØŸ ğŸ“',
      type: 'options',
      options: ['Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©', 'Ø§Ù„Ù‚ØµÙŠÙ…', 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©', 'Ø¹Ø³ÙŠØ±', 'ØªØ¨ÙˆÙƒ', 'Ø­Ø§Ø¦Ù„', 'Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©', 'Ø¬Ø§Ø²Ø§Ù†', 'Ù†Ø¬Ø±Ø§Ù†', 'Ø§Ù„Ø¨Ø§Ø­Ø©', 'Ø§Ù„Ø¬ÙˆÙ'],
      required: true,
      autoNext: true,
      show: (a) => a.financeType === 'ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'
    }
  ];
}

// ==================== Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ====================
function startCalculator() {
  // ÙØ­Øµ Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  const isLocked = loadData(STORAGE_KEYS.platformLock, false);
  if (isLocked) {
    alert('Ø§Ù„Ù…Ù†ØµØ© Ù…Ù‚ÙÙ„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„.');
    return;
  }
  
  answers = {};
  currentStep = 0;
  showPage('calculator');
  showCurrentQuestion();
}

function resetCalculator() {
  answers = {};
  currentStep = 0;
  showPage('calculator');
  showCurrentQuestion();
}

function goBackToFinanceType() {
  // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø³Ø¤Ø§Ù„ Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„
  const questions = getQuestions();
  const financeIndex = questions.findIndex(q => q.id === 'financeType');
  if (financeIndex >= 0) {
    currentStep = financeIndex;
    showCurrentQuestion();
    showPage('calculator');
  }
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ ====================
function showCurrentQuestion() {
  const questions = getQuestions();
  const container = document.getElementById('questionContainer');
  const buttonsContainer = document.getElementById('buttonsContainer');
  
  // ØªØ®Ø·ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙŠ Ù„Ø§ ØªÙ†Ø·Ø¨Ù‚
  while (currentStep < questions.length) {
    const q = questions[currentStep];
    if (q.show && !q.show(answers)) {
      currentStep++;
      continue;
    }
    break;
  }
  
  // Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø©ØŒ Ø§Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  if (currentStep >= questions.length) {
    calculateResult();
    return;
  }
  
  const q = questions[currentStep];
  totalSteps = questions.filter(qq => !qq.show || qq.show(answers)).length;
  
  // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
  const progress = ((currentStep + 1) / totalSteps) * 100;
  document.getElementById('progressFill').style.width = progress + '%';
  
  // Ø¨Ù†Ø§Ø¡ HTML Ø§Ù„Ø³Ø¤Ø§Ù„
  let html = `<div class="fade-in">`;
  html += `<label style="font-size:18px; margin-bottom:12px;">${q.label}</label>`;
  
  if (q.type === 'text') {
    html += `<input type="text" id="answer" placeholder="${q.placeholder || ''}" onkeypress="handleEnter(event)">`;
  } else if (q.type === 'number') {
    html += `<input type="number" id="answer" placeholder="${q.placeholder || ''}" onkeypress="handleEnter(event)" inputmode="numeric">`;
  } else if (q.type === 'options') {
    html += `<div class="option-grid">`;
    q.options.forEach((opt, i) => {
      html += `<div class="option-btn" onclick="selectOption('${escapeHtml(opt)}')">${escapeHtml(opt)}</div>`;
    });
    html += `</div>`;
  } else if (q.type === 'date-hijri') {
    const now = getHijriParts();
    html += `<div class="date-row">`;
    // Ø§Ù„ÙŠÙˆÙ…
    html += `<select id="birthDay" onchange="checkDateComplete()">`;
    html += `<option value="">Ø§Ù„ÙŠÙˆÙ…</option>`;
    for (let i = 1; i <= 30; i++) {
      html += `<option value="${i}">${i}</option>`;
    }
    html += `</select>`;
    // Ø§Ù„Ø´Ù‡Ø±
    html += `<select id="birthMonth" onchange="checkDateComplete()">`;
    html += `<option value="">Ø§Ù„Ø´Ù‡Ø±</option>`;
    for (let i = 1; i <= 12; i++) {
      html += `<option value="${i}">${i}</option>`;
    }
    html += `</select>`;
    // Ø§Ù„Ø³Ù†Ø©
    html += `<select id="birthYear" onchange="checkDateComplete()">`;
    html += `<option value="">Ø§Ù„Ø³Ù†Ø©</option>`;
    for (let y = now.y - 18; y >= now.y - 70; y--) {
      html += `<option value="${y}">${y}</option>`;
    }
    html += `</select>`;
    html += `</div>`;
  } else if (q.type === 'select-months') {
    const maxMonths = calculateMaxMonths();
    html += `<select id="answer" onchange="handleSelectChange()">`;
    html += `<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø©</option>`;
    const isPersonal = ['ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ', 'ØªÙ…ÙˆÙŠÙ„ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ', 'ØªÙ…ÙˆÙŠÙ„ ØªØ£Ø¬ÙŠØ±ÙŠ', 'Ø´Ø±Ø§Ø¡ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'].includes(answers.financeType);
    const limit = Math.min(maxMonths, isPersonal ? 60 : 300);
    for (let i = 6; i <= limit; i += 6) {
      html += `<option value="${i}">${formatMonths(i)}</option>`;
    }
    html += `</select>`;
  }
  
  html += `</div>`;
  container.innerHTML = html;
  
  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
  let buttons = '';
  if (currentStep > 0) {
    buttons += `<button class="secondary small" onclick="previousQuestion()">â¬…ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>`;
  }
  if (!q.autoNext || q.type === 'text' || q.type === 'number') {
    buttons += `<button class="primary small" onclick="nextQuestion()">Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>`;
  }
  buttons += `<button class="reset-btn-small" onclick="resetCalculator()">ğŸ”„</button>`;
  buttonsContainer.innerHTML = buttons;
  
  // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
  const input = document.getElementById('answer');
  if (input) {
    setTimeout(() => input.focus(), 100);
  }
}

function handleEnter(e) {
  if (e.key === 'Enter') {
    nextQuestion();
  }
}

function handleSelectChange() {
  const q = getQuestions()[currentStep];
  if (q && q.autoNext) {
    const val = document.getElementById('answer')?.value;
    if (val) {
      nextQuestion();
    }
  }
}

function checkDateComplete() {
  const day = document.getElementById('birthDay')?.value;
  const month = document.getElementById('birthMonth')?.value;
  const year = document.getElementById('birthYear')?.value;
  
  if (day && month && year) {
    answers.birthDay = day;
    answers.birthMonth = month;
    answers.birthYear = year;
    setTimeout(() => nextQuestion(), 300);
  }
}

function selectOption(value) {
  const q = getQuestions()[currentStep];
  answers[q.id] = value;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´ÙƒÙ„
  document.querySelectorAll('.option-btn').forEach(btn => {
    btn.classList.remove('selected');
    if (btn.textContent === value) {
      btn.classList.add('selected');
    }
  });
  
  // ÙØ­Øµ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ÙØ¹Ù„Ø©
  if (q.id === 'financeType') {
    const products = loadData(STORAGE_KEYS.products, getDefaultProducts());
    const product = products.find(p => p.name === value);
    if (product && !product.enabled) {
      document.getElementById('comingSoonTitle').textContent = value;
      document.getElementById('comingSoonText').textContent = product.message || 'Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡.';
      showPage('comingSoon');
      return;
    }
  }
  
  if (q.autoNext) {
    setTimeout(() => nextQuestion(), 300);
  }
}

function nextQuestion() {
  const questions = getQuestions();
  const q = questions[currentStep];
  
  // Ø¬Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
  if (q.type === 'text' || q.type === 'number') {
    const val = document.getElementById('answer')?.value?.trim();
    if (!val && q.required) {
      const name = answers.clientName || 'Ø¹Ø²ÙŠØ²ÙŠ';
      alert(getRandomPhrase('funnyResponses', name).replace(/{name}/g, name) || 'ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚Ù„');
      return;
    }
    answers[q.id] = val;
  } else if (q.type === 'select-months') {
    const val = document.getElementById('answer')?.value;
    if (!val && q.required) {
      alert('Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø© Ù…Ù† ÙØ¶Ù„Ùƒ');
      return;
    }
    answers[q.id] = val;
  } else if (q.type === 'date-hijri') {
    if (!answers.birthDay || !answers.birthMonth || !answers.birthYear) {
      alert('Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ÙƒØ§Ù…Ù„Ø§Ù‹');
      return;
    }
  } else if (q.type === 'options') {
    if (!answers[q.id] && q.required) {
      alert('Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª');
      return;
    }
  }
  
  // Ø§Ù„ØªØ±Ø´ÙŠØ­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨Ù†Ùƒ
  if (q.id === 'calcMode' && answers.calcMode === 'Ø±Ø´Ø­ Ù„ÙŠ Ø¨Ù†Ùƒ Ù…Ù†Ø§Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹') {
    const recommended = getRecommendedBank();
    if (recommended) {
      answers.recommendedBank = recommended;
      answers.profitMargin = recommended.margin;
    }
  }
  
  currentStep++;
  showCurrentQuestion();
}

function previousQuestion() {
  if (currentStep > 0) {
    currentStep--;
    // ØªØ®Ø·ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø®ÙÙŠØ© Ù„Ù„Ø®Ù„Ù
    const questions = getQuestions();
    while (currentStep > 0) {
      const q = questions[currentStep];
      if (q.show && !q.show(answers)) {
        currentStep--;
        continue;
      }
      break;
    }
    showCurrentQuestion();
  }
}

// ==================== Ø­Ø³Ø§Ø¨ Ø£Ù‚ØµÙ‰ Ù…Ø¯Ø© ====================
function calculateMaxMonths() {
  const now = getHijriParts();
  const birthYear = parseInt(answers.birthYear || '0');
  const birthMonth = parseInt(answers.birthMonth || '1');
  
  if (!birthYear) return 60;
  
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  let maxAge = settings.maxAge || 60;
  
  // Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠ
  if (answers.jobType === 'Ø¹Ø³ÙƒØ±ÙŠ' && answers.militaryRank) {
    const retAge = getRetirementAge(answers.militaryRank);
    if (answers.extendAfterRetirement === 'Ù†Ø¹Ù…') {
      maxAge = 60;
    } else {
      maxAge = retAge;
    }
  }
  
  const retYear = birthYear + maxAge;
  const retMonth = birthMonth;
  
  const remainingMonths = monthsDiff(now.y, now.m, retYear, retMonth);
  return Math.max(0, remainingMonths);
}

// ==================== ØªØ±Ø´ÙŠØ­ Ø§Ù„Ø¨Ù†Ùƒ ====================
function getRecommendedBank() {
  const bankConfigs = loadData('fino_bank_configs', []);
  const salary = parseFloat(answers.salary || '0');
  const months = parseInt(answers.months || '0');
  
  if (!salary || !months) return null;
  
  // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„
  let fType = 'personal';
  if (answers.financeType?.includes('Ø¹Ù‚Ø§Ø±ÙŠ')) fType = 'mortgage';
  else if (answers.financeType?.includes('Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©')) fType = 'buyout';
  
  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ù†Ø³Ø¨Ø©
  const matching = bankConfigs.filter(cfg => {
    if (cfg.financeType !== fType) return false;
    if (salary < cfg.minSalary || salary > cfg.maxSalary) return false;
    if (cfg.minMonths && months < cfg.minMonths) return false;
    if (cfg.maxMonths && months > cfg.maxMonths) return false;
    if (cfg.jobType && cfg.jobType !== answers.jobType) return false;
    return true;
  });
  
  if (matching.length === 0) return null;
  
  // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø£Ù‚Ù„ Ù†Ø³Ø¨Ø©
  matching.sort((a, b) => a.margin - b.margin);
  return matching[0];
}

</script>

<script>
// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© ====================
function calculateResult() {
  const name = answers.clientName || 'Ø¹Ø²ÙŠØ²ÙŠ Ø§Ù„Ø¹Ù…ÙŠÙ„';
  const salary = parseFloat(answers.salary || '0');
  const months = parseInt(answers.months || '0');
  const margin = parseFloat(answers.profitMargin || '4.5');
  const commitmentAmount = parseFloat(answers.commitmentAmount || '0');
  const commitmentMonths = parseInt(answers.commitmentMonths || '0');
  const buyoutAmount = parseFloat(answers.buyoutAmount || '0');
  
  // Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ‚Ø·Ø§Ø¹
  let deductionRate = 0.33; // Ø§ÙØªØ±Ø§Ø¶ÙŠ 33%
  if (answers.financeType?.includes('Ø¹Ù‚Ø§Ø±ÙŠ')) {
    deductionRate = 0.65; // 65% Ù„Ù„Ø¹Ù‚Ø§Ø±ÙŠ
  }
  
  // Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù…ØªØ§Ø­ Ù„Ù„Ø§Ø³ØªÙ‚Ø·Ø§Ø¹
  const availableSalary = salary * deductionRate;
  
  // Ø®ØµÙ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª
  let netAvailable = availableSalary;
  if (commitmentAmount > 0 && commitmentMonths > 6) {
    netAvailable = availableSalary - commitmentAmount;
  }
  
  if (netAvailable <= 0) {
    showErrorResult(name, 'Ù„Ù„Ø£Ø³Ù Ø§Ù„ØªØ²Ø§Ù…Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØªØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ù„Ù„Ø§Ø³ØªÙ‚Ø·Ø§Ø¹.');
    return;
  }
  
  // Ø­Ø³Ø§Ø¨ Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ…ÙˆÙŠÙ„
  const monthlyRate = (margin / 100) / 12;
  let principal = 0;
  
  if (monthlyRate > 0) {
    // Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø«Ø§Ø¨Øª (PMT)
    principal = netAvailable * ((1 - Math.pow(1 + monthlyRate, -months)) / monthlyRate);
  } else {
    principal = netAvailable * months;
  }
  
  // Ø®ØµÙ… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø¥Ù† ÙˆØ¬Ø¯Øª
  let finalAmount = principal;
  if (buyoutAmount > 0) {
    finalAmount = principal - buyoutAmount;
  }
  
  if (finalAmount <= 0) {
    showErrorResult(name, 'Ù„Ù„Ø£Ø³Ù Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø£ÙƒØ¨Ø± Ù…Ù† Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø­.');
    return;
  }
  
  // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· ÙˆØ§Ù„Ø£Ø±Ø¨Ø§Ø­
  const totalPayments = netAvailable * months;
  const totalProfit = totalPayments - principal;
  const monthlyInstallment = netAvailable;
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠ
  let retirementInfo = null;
  if (answers.jobType === 'Ø¹Ø³ÙƒØ±ÙŠ' && answers.militaryRank) {
    const now = getHijriParts();
    const birthYear = parseInt(answers.birthYear || '0');
    const retAge = getRetirementAge(answers.militaryRank);
    const retYear = birthYear + retAge;
    const yearsToRetirement = retYear - now.y;
    
    // ØªÙ‚Ø¯ÙŠØ± Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¯Ù…Ø© (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
    const estimatedServiceYears = now.y - birthYear - 20; // Ø§ÙØªØ±Ø§Ø¶ Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù†Ø¯ 20
    const retirementSalary = calculateRetirementSalary(salary, Math.max(estimatedServiceYears, 0), 'Ø¹Ø³ÙƒØ±ÙŠ');
    
    retirementInfo = {
      retirementYear: retYear,
      yearsRemaining: yearsToRetirement,
      estimatedSalary: retirementSalary
    };
  }
  
  // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  const result = {
    timestamp: Date.now(),
    clientName: name,
    financeType: answers.financeType,
    salary: salary,
    months: months,
    margin: margin,
    finalNet: Math.round(finalAmount),
    monthlyInst: Math.round(monthlyInstallment),
    totalPayments: Math.round(totalPayments),
    totalProfit: Math.round(totalProfit),
    bankName: answers.recommendedBank?.bankName || '',
    retirementInfo: retirementInfo,
    commitments: commitmentAmount,
    region: answers.region || ''
  };
  
  // Ø­ÙØ¸ ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
  saveResult(result);
  
  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  showResult(result);
}

function showErrorResult(name, message) {
  const greeting = getRandomPhrase('greetings', name);
  
  let html = `
    <div class="fade-in">
      <div class="marketing-msg">${greeting}</div>
      <div class="alert-error" style="margin-top:16px;">
        <strong>âš ï¸ ${message}</strong>
      </div>
      <p style="font-size:14px; color:#6b7280; margin-top:16px;">
        ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ ÙˆØ¨Ù†Ø³Ø§Ø¹Ø¯Ùƒ Ù†Ù„Ø§Ù‚ÙŠ Ø­Ù„ Ù…Ù†Ø§Ø³Ø¨ Ù„ÙˆØ¶Ø¹Ùƒ ğŸ’ª
      </p>
    </div>
  `;
  
  document.getElementById('resultCard').innerHTML = html;
  showPage('result');
}

function showResult(result) {
  const name = result.clientName;
  const greeting = getRandomPhrase('greetings', name);
  const closing = getRandomPhrase('closings', name);
  const goodNews = getRandomPhrase('goodNews', name);
  
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  
  let html = `<div class="fade-in">`;
  
  // Ø§Ù„ØªØ±Ø­ÙŠØ¨
  html += `<div class="marketing-msg">${greeting}</div>`;
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠ
  if (result.retirementInfo) {
    html += `
      <div class="retirement-box">
        <h4>ğŸ–ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ</h4>
        <div class="retirement-info">
          <div>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: <strong>${result.retirementInfo.retirementYear} Ù‡Ù€</strong></div>
          <div>â³ Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: <strong>${result.retirementInfo.yearsRemaining} Ø³Ù†Ø©</strong></div>
          <div>ğŸ’° Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: <strong>${formatMoney(result.retirementInfo.estimatedSalary)}</strong></div>
        </div>
      </div>
    `;
  }
  
  // Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ…ÙˆÙŠÙ„
  html += `
    <div class="result-box">
      <div class="result-label">ğŸ’° Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</div>
      <div class="result-amount">
        <span class="money-icon">ğŸ’µ</span>
        ${result.finalNet.toLocaleString('ar-SA')}
      </div>
      <div class="result-amount-words">${numberToArabicWords(result.finalNet)}</div>
    </div>
  `;
  
  // ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„
  html += `
    <div style="background:#f8fafc; border-radius:16px; padding:16px; margin:12px 0; text-align:right;">
      <div style="font-size:14px; color:#374151; line-height:2;">
        <div>ğŸ“Š Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„: <strong>${result.financeType}</strong></div>
        <div>ğŸ“† Ø§Ù„Ù…Ø¯Ø©: <strong>${formatMonths(result.months)}</strong></div>
        <div>ğŸ“ˆ Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­: <strong>${result.margin}%</strong></div>
        <div>ğŸ’³ Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ: <strong>${formatMoney(result.monthlyInst)}</strong></div>
        <div>ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¯Ø§Ø¯: <strong>${formatMoney(result.totalPayments)}</strong></div>
        <div>ğŸ“‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: <strong>${formatMoney(result.totalProfit)}</strong></div>
      </div>
    </div>
  `;
  
  // Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±Ø´Ø­
  if (result.bankName) {
    html += `
      <div class="bank-card">
        <div class="bank-logo">ğŸ¦</div>
        <div>
          <div class="bank-name">${result.bankName}</div>
          <div class="bank-rate">Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±Ø´Ø­ Ø¨Ø£Ù‚Ù„ Ù†Ø³Ø¨Ø©</div>
        </div>
      </div>
    `;
    html += `<div class="alert-success">${goodNews}</div>`;
  }
  
  // Ù†ØµÙŠØ­Ø© Ø®Ø·Ø§Ø¨ Ù„Ø§ Ù…Ø§Ù†Ø¹Ø©
  if (result.commitments > 0 && parseInt(answers.commitmentMonths || '0') > 6) {
    const advice = getRandomPhrase('advice', name);
    html += `<div class="alert-info">${advice}</div>`;
  }
  
  // Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù
  const targetedAd = getTargetedAd(result);
  if (targetedAd) {
    html += `
      <div class="ad-box">
        <div class="ad-title">${targetedAd.title}</div>
        <div class="ad-text">${targetedAd.text}</div>
        ${targetedAd.link ? `<a href="${targetedAd.link}" target="_blank" style="color:#065f46; font-size:13px;">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ù…Ø²ÙŠØ¯ â†</a>` : ''}
      </div>
    `;
  }
  
  // Ø§Ù„ØªØ³ÙˆÙŠÙ‚
  if (settings.marketingVisible && settings.marketingText) {
    html += `
      <div style="background:linear-gradient(135deg, #dbeafe, #eff6ff); border-radius:16px; padding:16px; margin:16px 0; text-align:center;">
        <div style="font-size:15px; color:#1e40af; font-weight:600;">${settings.marketingText}</div>
      </div>
    `;
  }
  
  // Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
  html += `
    <div class="rating-box">
      <div style="font-size:14px; color:#374151; margin-bottom:8px;">ÙƒÙŠÙ ÙƒØ§Ù†Øª ØªØ¬Ø±Ø¨ØªÙƒØŸ â­</div>
      <div class="stars" id="ratingStars">
        <span onclick="setRating(1)">â˜†</span>
        <span onclick="setRating(2)">â˜†</span>
        <span onclick="setRating(3)">â˜†</span>
        <span onclick="setRating(4)">â˜†</span>
        <span onclick="setRating(5)">â˜†</span>
      </div>
      <textarea id="reviewText" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="margin-top:10px; height:60px; font-size:14px;"></textarea>
      <button class="secondary small" onclick="submitReview()" style="margin-top:8px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
    </div>
  `;
  
  // Ø§Ù„Ø®ØªØ§Ù…
  html += `<div class="marketing-msg" style="margin-top:16px;">${closing}</div>`;
  
  html += `</div>`;
  
  document.getElementById('resultCard').innerHTML = html;
  
  // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ø¹Ù‚Ø¯
  const contractBtn = document.getElementById('contractBtn');
  if (contractBtn) {
    if (settings.contractLink && settings.contractButtonVisible) {
      contractBtn.style.display = 'inline-flex';
      contractBtn.textContent = 'ğŸ“ ' + (settings.contractButtonText || 'Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯');
    } else {
      contractBtn.style.display = 'none';
    }
  }
  
  showPage('result');
}

// ==================== Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ====================
function saveResult(result) {
  const results = loadData(STORAGE_KEYS.results, []);
  results.unshift(result);
  // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¢Ø®Ø± 100 Ù†ØªÙŠØ¬Ø©
  if (results.length > 100) {
    results.pop();
  }
  saveData(STORAGE_KEYS.results, results);
}

// ==================== Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ====================
function getTargetedAd(result) {
  const ads = loadData(STORAGE_KEYS.ads, []);
  if (ads.length === 0) return null;
  
  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù† Ù…Ù†Ø§Ø³Ø¨
  let targetType = 'all';
  if (result.financeType?.includes('Ø¹Ù‚Ø§Ø±ÙŠ')) targetType = 'mortgage';
  else if (result.financeType?.includes('Ø´Ø®ØµÙŠ')) targetType = 'personal';
  else if (result.financeType?.includes('ØªØ£Ø¬ÙŠØ±ÙŠ') || result.financeType?.includes('Ø³ÙŠØ§Ø±Ø§Øª')) targetType = 'car';
  
  const matching = ads.filter(ad => {
    if (ad.targetType === 'all') return true;
    if (ad.targetType === targetType) return true;
    if (ad.targetRegion && ad.targetRegion !== result.region) return false;
    return false;
  });
  
  if (matching.length === 0) return null;
  return matching[Math.floor(Math.random() * matching.length)];
}

// ==================== Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ====================
let currentRating = 0;

function setRating(stars) {
  currentRating = stars;
  const starsEl = document.getElementById('ratingStars');
  if (starsEl) {
    const spans = starsEl.querySelectorAll('span');
    spans.forEach((span, i) => {
      span.textContent = i < stars ? 'â˜…' : 'â˜†';
      span.classList.toggle('active', i < stars);
    });
  }
}

function submitReview() {
  if (currentRating === 0) {
    alert('Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ… Ù…Ù† ÙØ¶Ù„Ùƒ');
    return;
  }
  
  const reviewText = document.getElementById('reviewText')?.value?.trim() || '';
  
  const review = {
    id: Date.now(),
    clientName: answers.clientName || 'Ø¹Ù…ÙŠÙ„',
    rating: currentRating,
    text: reviewText,
    date: new Date().toLocaleDateString('ar-SA'),
    published: false
  };
  
  const reviews = loadData(STORAGE_KEYS.reviews, []);
  reviews.unshift(review);
  saveData(STORAGE_KEYS.reviews, reviews);
  
  alert('Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ùƒ! ğŸ™');
  document.getElementById('reviewText').value = '';
  setRating(0);
}

// ==================== Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§ØªØ³Ø§Ø¨ ====================
function shareOnWhatsApp() {
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  const name = answers.clientName || 'Ø¹Ù…ÙŠÙ„';
  const results = loadData(STORAGE_KEYS.results, []);
  const lastResult = results[0];
  
  if (!lastResult) {
    alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªÙŠØ¬Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©');
    return;
  }
  
  let message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ğŸ‘‹\n`;
  message += `Ù…ÙˆØ¬Ù‡ Ù…Ù† Ù…Ù†ØµØ© FINO\n\n`;
  message += `Ø§Ù„Ø§Ø³Ù…: ${lastResult.clientName}\n`;
  message += `Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„: ${lastResult.financeType}\n`;
  message += `Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ…ÙˆÙŠÙ„: ${formatMoney(lastResult.finalNet)}\n`;
  message += `Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ: ${formatMoney(lastResult.monthlyInst)}\n`;
  message += `Ø§Ù„Ù…Ø¯Ø©: ${formatMonths(lastResult.months)}\n`;
  if (lastResult.bankName) {
    message += `Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±Ø´Ø­: ${lastResult.bankName}\n`;
  }
  
  const phone = settings.whatsappNumber || '';
  const url = phone 
    ? `https://wa.me/${phone}?text=${encodeURIComponent(message)}`
    : `https://wa.me/?text=${encodeURIComponent(message)}`;
  
  window.open(url, '_blank');
}

// ==================== Ø­ÙØ¸ ÙƒØµÙˆØ±Ø© ====================
function saveAsImage() {
  const card = document.getElementById('resultCard');
  if (!card) return;
  
  html2canvas(card, {
    scale: 2,
    backgroundColor: '#ffffff',
    useCORS: true
  }).then(canvas => {
    const link = document.createElement('a');
    link.download = `fino-result-${Date.now()}.png`;
    link.href = canvas.toDataURL('image/png');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }).catch(err => {
    console.error(err);
    alert('ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©');
  });
}

// ==================== Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯ ====================
function openContract() {
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  if (settings.contractLink) {
    window.open(settings.contractLink, '_blank');
  } else {
    alert('Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ù‚Ø¯. ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„.');
  }
}

</script>

<script>
// ==================== Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ====================
function handleAdminLogin() {
  const pin = document.getElementById('adminPin').value;
  const errorEl = document.getElementById('adminLoginError');
  
  if (pin === ADMIN_PIN) {
    errorEl.style.display = 'none';
    
    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø§Ø¬Ø­
    logLoginAttempt(true);
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
    getAdminLocation();
    
    showPage('adminHub');
    updateLockButton();
  } else {
    errorEl.style.display = 'block';
    
    // ØªØ³Ø¬ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø© ÙØ§Ø´Ù„Ø©
    logLoginAttempt(false);
  }
}

function logLoginAttempt(success) {
  const logs = loadData(STORAGE_KEYS.loginLogs, []);
  
  const log = {
    id: Date.now(),
    date: new Date().toLocaleString('ar-SA'),
    success: success,
    userAgent: navigator.userAgent,
    platform: navigator.platform,
    location: null
  };
  
  // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        log.location = {
          lat: pos.coords.latitude,
          lng: pos.coords.longitude
        };
        logs.unshift(log);
        saveData(STORAGE_KEYS.loginLogs, logs.slice(0, 50));
      },
      () => {
        logs.unshift(log);
        saveData(STORAGE_KEYS.loginLogs, logs.slice(0, 50));
      }
    );
  } else {
    logs.unshift(log);
    saveData(STORAGE_KEYS.loginLogs, logs.slice(0, 50));
  }
}

function getAdminLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        console.log('Admin location:', pos.coords.latitude, pos.coords.longitude);
      },
      (err) => {
        console.log('Location error:', err);
      }
    );
  }
}

// ==================== ØµÙØ­Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ====================
function showAdminPage(page) {
  switch(page) {
    case 'banks':
      renderBanksPage();
      openModal('banksModal');
      break;
    case 'jobs':
      renderJobsPage();
      openModal('jobsModal');
      break;
    case 'products':
      renderProductsPage();
      openModal('productsModal');
      break;
    case 'results':
      renderResultsPage();
      openModal('resultsModal');
      break;
    case 'ads':
      renderAdsPage();
      openModal('adsModal');
      break;
    case 'offers':
      renderOffersPage();
      openModal('offersModal');
      break;
    case 'reviews':
      renderReviewsPage();
      openModal('reviewsModal');
      break;
    case 'settings':
      renderSettingsPage();
      openModal('settingsModal');
      break;
    case 'carLeasing':
      renderCarLeasingPage();
      openModal('carLeasingModal');
      break;
    case 'docs':
      renderDocsPage();
      openModal('docsModal');
      break;
    case 'loginLogs':
      renderLoginLogsPage();
      openModal('loginLogsModal');
      break;
  }
}

// ==================== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„Ù†Ø³Ø¨ ====================
function renderBanksPage() {
  const banks = loadData(STORAGE_KEYS.banks, getDefaultBanks());
  const configs = loadData('fino_bank_configs', []);
  
  let html = `
    <div style="margin-bottom:16px;">
      <h4 style="margin:0 0 12px;">Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø¨Ù†Ùƒ</h4>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <input type="text" id="bankName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ">
        <input type="text" id="bankLogo" placeholder="Ø±Ù…Ø² Ø§Ù„Ø´Ø¹Ø§Ø± (emoji)">
      </div>
      <button class="primary small" onclick="saveBank()" style="margin-top:10px;">Ø­ÙØ¸ Ø§Ù„Ø¨Ù†Ùƒ</button>
    </div>
    
    <h4>Ø§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
    <table class="admin-table">
      <thead>
        <tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø´Ø¹Ø§Ø±</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>ØªØ­ÙƒÙ…</th></tr>
      </thead>
      <tbody>
  `;
  
  banks.forEach((bank, i) => {
    html += `
      <tr>
        <td>${escapeHtml(bank.name)}</td>
        <td>${bank.logo || 'ğŸ¦'}</td>
        <td>${bank.enabled ? 'âœ…' : 'âŒ'}</td>
        <td>
          <button class="secondary small" onclick="toggleBank(${i})">${bank.enabled ? 'Ø¥ÙŠÙ‚Ø§Ù' : 'ØªÙØ¹ÙŠÙ„'}</button>
          <button class="secondary small" onclick="deleteBank(${i})">Ø­Ø°Ù</button>
        </td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø³Ø¨
  html += `
    <hr style="margin:20px 0;">
    <h4>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø³Ø¨</h4>
    <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-bottom:10px;">
      <select id="cfgBank">
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ù†Ùƒ</option>
        ${banks.filter(b => b.enabled).map(b => `<option value="${b.name}">${b.name}</option>`).join('')}
      </select>
      <select id="cfgType">
        <option value="personal">ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ</option>
        <option value="mortgage">ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ</option>
        <option value="car">ØªÙ…ÙˆÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª</option>
        <option value="buyout">Ø´Ø±Ø§Ø¡ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</option>
      </select>
      <select id="cfgAgeCalc">
        <option value="hijri">Ø§Ù„Ø¹Ù…Ø± Ù‡Ø¬Ø±ÙŠ</option>
        <option value="gregorian">Ø§Ù„Ø¹Ù…Ø± Ù…ÙŠÙ„Ø§Ø¯ÙŠ</option>
      </select>
    </div>
    <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px; margin-bottom:10px;">
      <input type="number" id="cfgMinSalary" placeholder="Ù…Ù† Ø±Ø§ØªØ¨">
      <input type="number" id="cfgMaxSalary" placeholder="Ø¥Ù„Ù‰ Ø±Ø§ØªØ¨">
      <input type="number" id="cfgMinMonths" placeholder="Ù…Ù† Ø´Ù‡Ø±">
      <input type="number" id="cfgMaxMonths" placeholder="Ø¥Ù„Ù‰ Ø´Ù‡Ø±">
    </div>
    <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-bottom:10px;">
      <input type="number" id="cfgMargin" placeholder="Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ %" step="0.01">
      <input type="number" id="cfgMaxAge" placeholder="Ø£Ù‚ØµÙ‰ Ø¹Ù…Ø± (Ø§ÙØªØ±Ø§Ø¶ÙŠ 60)">
      <select id="cfgJobType">
        <option value="">ÙƒÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</option>
        <option value="Ø¹Ø³ÙƒØ±ÙŠ">Ø¹Ø³ÙƒØ±ÙŠ</option>
        <option value="Ù…Ø¯Ù†ÙŠ">Ù…Ø¯Ù†ÙŠ</option>
        <option value="Ø®Ø§Øµ">Ø®Ø§Øµ</option>
        <option value="Ù…ØªÙ‚Ø§Ø¹Ø¯">Ù…ØªÙ‚Ø§Ø¹Ø¯</option>
      </select>
    </div>
    <button class="primary small" onclick="saveBankConfig()">Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨Ø©</button>
    
    <h4 style="margin-top:16px;">Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h4>
    <table class="admin-table">
      <thead>
        <tr><th>Ø§Ù„Ø¨Ù†Ùƒ</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø±Ø§ØªØ¨</th><th>Ø§Ù„Ù…Ø¯Ø©</th><th>Ø§Ù„Ù†Ø³Ø¨Ø©</th><th>Ø§Ù„Ø¹Ù…Ø±</th><th>ØªØ­ÙƒÙ…</th></tr>
      </thead>
      <tbody>
  `;
  
  configs.forEach((cfg, i) => {
    html += `
      <tr>
        <td>${cfg.bankName}</td>
        <td>${cfg.financeType}</td>
        <td>${cfg.minSalary}-${cfg.maxSalary}</td>
        <td>${cfg.minMonths || '-'}-${cfg.maxMonths || '-'}</td>
        <td>${cfg.margin}%</td>
        <td>${cfg.maxAge || 60}</td>
        <td><button class="secondary small" onclick="deleteBankConfig(${i})">Ø­Ø°Ù</button></td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  
  document.getElementById('banksContent').innerHTML = html;
}

function saveBank() {
  const name = document.getElementById('bankName').value.trim();
  const logo = document.getElementById('bankLogo').value.trim() || 'ğŸ¦';
  
  if (!name) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ');
    return;
  }
  
  const banks = loadData(STORAGE_KEYS.banks, getDefaultBanks());
  banks.push({ id: Date.now(), name, logo, enabled: true });
  saveData(STORAGE_KEYS.banks, banks);
  
  document.getElementById('bankName').value = '';
  document.getElementById('bankLogo').value = '';
  renderBanksPage();
}

function toggleBank(index) {
  const banks = loadData(STORAGE_KEYS.banks, getDefaultBanks());
  banks[index].enabled = !banks[index].enabled;
  saveData(STORAGE_KEYS.banks, banks);
  renderBanksPage();
}

function deleteBank(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù†ÙƒØŸ')) return;
  const banks = loadData(STORAGE_KEYS.banks, getDefaultBanks());
  banks.splice(index, 1);
  saveData(STORAGE_KEYS.banks, banks);
  renderBanksPage();
}

function saveBankConfig() {
  const bankName = document.getElementById('cfgBank').value;
  const financeType = document.getElementById('cfgType').value;
  const minSalary = parseInt(document.getElementById('cfgMinSalary').value) || 0;
  const maxSalary = parseInt(document.getElementById('cfgMaxSalary').value) || 999999;
  const minMonths = parseInt(document.getElementById('cfgMinMonths').value) || 0;
  const maxMonths = parseInt(document.getElementById('cfgMaxMonths').value) || 360;
  const margin = parseFloat(document.getElementById('cfgMargin').value) || 0;
  const maxAge = parseInt(document.getElementById('cfgMaxAge').value) || 60;
  const ageCalc = document.getElementById('cfgAgeCalc').value;
  const jobType = document.getElementById('cfgJobType').value;
  
  if (!bankName || !margin) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ù†Ùƒ ÙˆØ§Ù„Ù†Ø³Ø¨Ø©');
    return;
  }
  
  const configs = loadData('fino_bank_configs', []);
  configs.push({ bankName, financeType, minSalary, maxSalary, minMonths, maxMonths, margin, maxAge, ageCalc, jobType });
  saveData('fino_bank_configs', configs);
  
  renderBanksPage();
}

function deleteBankConfig(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø¨Ø©ØŸ')) return;
  const configs = loadData('fino_bank_configs', []);
  configs.splice(index, 1);
  saveData('fino_bank_configs', configs);
  renderBanksPage();
}

// ==================== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ====================
function renderJobsPage() {
  const jobs = loadData(STORAGE_KEYS.jobs, getDefaultJobs());
  
  let html = `
    <div style="margin-bottom:16px;">
      <input type="text" id="newJobName" placeholder="Ø§Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ©">
      <button class="primary small" onclick="addJob()" style="margin-top:10px;">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  jobs.forEach((job, i) => {
    html += `
      <tr>
        <td>${escapeHtml(job.name)}</td>
        <td>${job.enabled ? 'âœ…' : 'âŒ'}</td>
        <td>
          <button class="secondary small" onclick="toggleJob(${i})">${job.enabled ? 'Ø¥ÙŠÙ‚Ø§Ù' : 'ØªÙØ¹ÙŠÙ„'}</button>
          <button class="secondary small" onclick="deleteJob(${i})">Ø­Ø°Ù</button>
        </td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('jobsContent').innerHTML = html;
}

function addJob() {
  const name = document.getElementById('newJobName').value.trim();
  if (!name) return;
  
  const jobs = loadData(STORAGE_KEYS.jobs, getDefaultJobs());
  jobs.push({ id: Date.now(), name, enabled: true });
  saveData(STORAGE_KEYS.jobs, jobs);
  
  document.getElementById('newJobName').value = '';
  renderJobsPage();
}

function toggleJob(index) {
  const jobs = loadData(STORAGE_KEYS.jobs, getDefaultJobs());
  jobs[index].enabled = !jobs[index].enabled;
  saveData(STORAGE_KEYS.jobs, jobs);
  renderJobsPage();
}

function deleteJob(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const jobs = loadData(STORAGE_KEYS.jobs, getDefaultJobs());
  jobs.splice(index, 1);
  saveData(STORAGE_KEYS.jobs, jobs);
  renderJobsPage();
}

// ==================== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ====================
function renderProductsPage() {
  const products = loadData(STORAGE_KEYS.products, getDefaultProducts());
  
  let html = `
    <div style="margin-bottom:16px;">
      <input type="text" id="newProductName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
      <input type="text" id="newProductMsg" placeholder="Ø±Ø³Ø§Ù„Ø© (Ø¥Ø°Ø§ ØºÙŠØ± Ù…ÙØ¹Ù„)">
      <button class="primary small" onclick="addProduct()" style="margin-top:10px;">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„Ø±Ø³Ø§Ù„Ø©</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  products.forEach((p, i) => {
    html += `
      <tr>
        <td>${escapeHtml(p.name)}</td>
        <td>${p.enabled ? 'âœ…' : 'âŒ'}</td>
        <td style="font-size:11px;">${escapeHtml(p.message || '-')}</td>
        <td>
          <button class="secondary small" onclick="toggleProduct(${i})">${p.enabled ? 'Ø¥ÙŠÙ‚Ø§Ù' : 'ØªÙØ¹ÙŠÙ„'}</button>
          <button class="secondary small" onclick="deleteProduct(${i})">Ø­Ø°Ù</button>
        </td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('productsContent').innerHTML = html;
}

function addProduct() {
  const name = document.getElementById('newProductName').value.trim();
  const message = document.getElementById('newProductMsg').value.trim();
  if (!name) return;
  
  const products = loadData(STORAGE_KEYS.products, getDefaultProducts());
  products.push({ id: Date.now(), name, enabled: true, message });
  saveData(STORAGE_KEYS.products, products);
  
  document.getElementById('newProductName').value = '';
  document.getElementById('newProductMsg').value = '';
  renderProductsPage();
}

function toggleProduct(index) {
  const products = loadData(STORAGE_KEYS.products, getDefaultProducts());
  products[index].enabled = !products[index].enabled;
  saveData(STORAGE_KEYS.products, products);
  renderProductsPage();
}

function deleteProduct(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const products = loadData(STORAGE_KEYS.products, getDefaultProducts());
  products.splice(index, 1);
  saveData(STORAGE_KEYS.products, products);
  renderProductsPage();
}

</script>

<script>
// ==================== Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ====================
function renderResultsPage() {
  const results = loadData(STORAGE_KEYS.results, []);
  
  let html = `
    <div style="margin-bottom:16px;">
      <input type="text" id="searchResults" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…..." oninput="filterResults()">
      <button class="secondary small" onclick="clearAllResults()" style="margin-right:10px;">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
    </div>
    <table class="admin-table" id="resultsTable">
      <thead>
        <tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø±Ø§ØªØ¨</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„Ù‚Ø³Ø·</th><th>Ø§Ù„Ø¨Ù†Ùƒ</th></tr>
      </thead>
      <tbody>
  `;
  
  results.forEach((r, i) => {
    const date = new Date(r.timestamp).toLocaleDateString('ar-SA');
    html += `
      <tr>
        <td>${date}</td>
        <td>${escapeHtml(r.clientName)}</td>
        <td>${escapeHtml(r.financeType)}</td>
        <td>${r.salary?.toLocaleString() || '-'}</td>
        <td>${r.finalNet?.toLocaleString() || '-'}</td>
        <td>${r.monthlyInst?.toLocaleString() || '-'}</td>
        <td>${escapeHtml(r.bankName || '-')}</td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('resultsContent').innerHTML = html;
}

function filterResults() {
  const query = document.getElementById('searchResults').value.toLowerCase();
  const rows = document.querySelectorAll('#resultsTable tbody tr');
  rows.forEach(row => {
    const text = row.textContent.toLowerCase();
    row.style.display = text.includes(query) ? '' : 'none';
  });
}

function clearAllResults() {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŸ')) return;
  saveData(STORAGE_KEYS.results, []);
  renderResultsPage();
}

// ==================== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ====================
function renderAdsPage() {
  const ads = loadData(STORAGE_KEYS.ads, []);
  
  let html = `
    <div style="margin-bottom:16px;">
      <input type="text" id="adTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†">
      <textarea id="adText" placeholder="Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" style="height:60px;"></textarea>
      <input type="text" id="adLink" placeholder="Ø±Ø§Ø¨Ø· (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;">
        <select id="adTargetType">
          <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
          <option value="personal">ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ</option>
          <option value="mortgage">ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ</option>
          <option value="car">ØªÙ…ÙˆÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª</option>
        </select>
        <select id="adTargetRegion">
          <option value="">ÙƒÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</option>
          <option value="Ø§Ù„Ø±ÙŠØ§Ø¶">Ø§Ù„Ø±ÙŠØ§Ø¶</option>
          <option value="Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©">Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©</option>
          <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
          <option value="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</option>
        </select>
      </div>
      <button class="primary small" onclick="saveAd()" style="margin-top:10px;">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
    </div>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  ads.forEach((ad, i) => {
    html += `
      <tr>
        <td>${escapeHtml(ad.title)}</td>
        <td>${ad.targetType || 'all'}</td>
        <td>${ad.targetRegion || 'Ø§Ù„ÙƒÙ„'}</td>
        <td><button class="secondary small" onclick="deleteAd(${i})">Ø­Ø°Ù</button></td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('adsContent').innerHTML = html;
}

function saveAd() {
  const title = document.getElementById('adTitle').value.trim();
  const text = document.getElementById('adText').value.trim();
  const link = document.getElementById('adLink').value.trim();
  const targetType = document.getElementById('adTargetType').value;
  const targetRegion = document.getElementById('adTargetRegion').value;
  
  if (!title || !text) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù†Øµ');
    return;
  }
  
  const ads = loadData(STORAGE_KEYS.ads, []);
  ads.push({ id: Date.now(), title, text, link, targetType, targetRegion });
  saveData(STORAGE_KEYS.ads, ads);
  
  document.getElementById('adTitle').value = '';
  document.getElementById('adText').value = '';
  document.getElementById('adLink').value = '';
  renderAdsPage();
}

function deleteAd(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const ads = loadData(STORAGE_KEYS.ads, []);
  ads.splice(index, 1);
  saveData(STORAGE_KEYS.ads, ads);
  renderAdsPage();
}

// ==================== Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ© ====================
function renderOffersPage() {
  const offers = loadData(STORAGE_KEYS.offers, []);
  
  let html = `
    <div style="margin-bottom:16px;">
      <input type="text" id="offerTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶">
      <textarea id="offerText" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶" style="height:60px;"></textarea>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;">
        <select id="offerTarget">
          <option value="all">Ù„Ù„Ø¬Ù…ÙŠØ¹</option>
          <option value="highCommitments">Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¹Ø§Ù„ÙŠØ©</option>
          <option value="lowSalary">Ø±Ø§ØªØ¨ Ù…Ù†Ø®ÙØ¶</option>
          <option value="military">Ø¹Ø³ÙƒØ±ÙŠ</option>
          <option value="retired">Ù…ØªÙ‚Ø§Ø¹Ø¯</option>
        </select>
        <input type="text" id="offerEmployer" placeholder="Ø¬Ù‡Ø© Ø¹Ù…Ù„ Ù…Ø¹ÙŠÙ†Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
      </div>
      <button class="primary small" onclick="saveOffer()" style="margin-top:10px;">Ø­ÙØ¸ Ø§Ù„Ø¹Ø±Ø¶</button>
    </div>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù</th><th>Ø§Ù„Ø¬Ù‡Ø©</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  offers.forEach((o, i) => {
    html += `
      <tr>
        <td>${escapeHtml(o.title)}</td>
        <td>${o.target || 'all'}</td>
        <td>${escapeHtml(o.employer || '-')}</td>
        <td><button class="secondary small" onclick="deleteOffer(${i})">Ø­Ø°Ù</button></td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('offersContent').innerHTML = html;
}

function saveOffer() {
  const title = document.getElementById('offerTitle').value.trim();
  const text = document.getElementById('offerText').value.trim();
  const target = document.getElementById('offerTarget').value;
  const employer = document.getElementById('offerEmployer').value.trim();
  
  if (!title || !text) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„');
    return;
  }
  
  const offers = loadData(STORAGE_KEYS.offers, []);
  offers.push({ id: Date.now(), title, text, target, employer });
  saveData(STORAGE_KEYS.offers, offers);
  
  document.getElementById('offerTitle').value = '';
  document.getElementById('offerText').value = '';
  document.getElementById('offerEmployer').value = '';
  renderOffersPage();
}

function deleteOffer(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const offers = loadData(STORAGE_KEYS.offers, []);
  offers.splice(index, 1);
  saveData(STORAGE_KEYS.offers, offers);
  renderOffersPage();
}

// ==================== Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ====================
function renderReviewsPage() {
  const reviews = loadData(STORAGE_KEYS.reviews, []);
  
  let html = `
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th><th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th><th>Ù…Ù†Ø´ÙˆØ±</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  reviews.forEach((r, i) => {
    const stars = 'â˜…'.repeat(r.rating) + 'â˜†'.repeat(5 - r.rating);
    html += `
      <tr>
        <td>${r.date}</td>
        <td>${escapeHtml(r.clientName)}</td>
        <td style="color:#fbbf24;">${stars}</td>
        <td style="font-size:11px;">${escapeHtml(r.text || '-')}</td>
        <td>${r.published ? 'âœ…' : 'âŒ'}</td>
        <td>
          <button class="secondary small" onclick="toggleReviewPublish(${i})">${r.published ? 'Ø¥Ø®ÙØ§Ø¡' : 'Ù†Ø´Ø±'}</button>
          <button class="secondary small" onclick="deleteReview(${i})">Ø­Ø°Ù</button>
        </td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('reviewsContent').innerHTML = html;
}

function toggleReviewPublish(index) {
  const reviews = loadData(STORAGE_KEYS.reviews, []);
  reviews[index].published = !reviews[index].published;
  saveData(STORAGE_KEYS.reviews, reviews);
  renderReviewsPage();
}

function deleteReview(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const reviews = loadData(STORAGE_KEYS.reviews, []);
  reviews.splice(index, 1);
  saveData(STORAGE_KEYS.reviews, reviews);
  renderReviewsPage();
}

// ==================== Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ====================
function renderSettingsPage() {
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  
  let html = `
    <div style="text-align:right;">
      <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©):</label>
      <input type="text" id="settingWhatsapp" value="${settings.whatsappNumber || ''}" placeholder="966500000000">
      
      <label>Ø±Ø§Ø¨Ø· Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯:</label>
      <input type="text" id="settingContract" value="${settings.contractLink || ''}" placeholder="https://...">
      
      <label>Ù†Øµ Ø²Ø± Ø§Ù„Ø¹Ù‚Ø¯:</label>
      <input type="text" id="settingContractText" value="${settings.contractButtonText || 'Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯'}">
      
      <label style="display:flex; align-items:center; gap:10px; margin-top:12px;">
        <input type="checkbox" id="settingContractVisible" ${settings.contractButtonVisible ? 'checked' : ''}>
        Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø¥Ø¨Ø±Ø§Ù… Ø§Ù„Ø¹Ù‚Ø¯
      </label>
      
      <label>Ù†Øµ Ø§Ù„ØªØ³ÙˆÙŠÙ‚:</label>
      <textarea id="settingMarketing" style="height:60px;">${settings.marketingText || ''}</textarea>
      
      <label style="display:flex; align-items:center; gap:10px; margin-top:12px;">
        <input type="checkbox" id="settingMarketingVisible" ${settings.marketingVisible ? 'checked' : ''}>
        Ø¥Ø¸Ù‡Ø§Ø± Ù†Øµ Ø§Ù„ØªØ³ÙˆÙŠÙ‚
      </label>
      
      <label style="display:flex; align-items:center; gap:10px; margin-top:12px;">
        <input type="checkbox" id="settingShowReviews" ${settings.showReviewsOnHome ? 'checked' : ''}>
        Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      </label>
      
      <label>Ø£Ù‚ØµÙ‰ Ø¹Ù…Ø± Ù„Ù„ØªÙ…ÙˆÙŠÙ„:</label>
      <input type="number" id="settingMaxAge" value="${settings.maxAge || 60}">
      
      <label>Ø·Ø±ÙŠÙ‚Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±:</label>
      <select id="settingAgeCalc">
        <option value="hijri" ${settings.ageCalculation === 'hijri' ? 'selected' : ''}>Ù‡Ø¬Ø±ÙŠ</option>
        <option value="gregorian" ${settings.ageCalculation === 'gregorian' ? 'selected' : ''}>Ù…ÙŠÙ„Ø§Ø¯ÙŠ</option>
      </select>
      
      <button class="primary" onclick="saveSettings()" style="margin-top:16px; width:100%;">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    </div>
  `;
  
  document.getElementById('settingsContent').innerHTML = html;
}

function saveSettings() {
  const settings = {
    whatsappNumber: document.getElementById('settingWhatsapp').value.trim(),
    contractLink: document.getElementById('settingContract').value.trim(),
    contractButtonText: document.getElementById('settingContractText').value.trim(),
    contractButtonVisible: document.getElementById('settingContractVisible').checked,
    marketingText: document.getElementById('settingMarketing').value.trim(),
    marketingVisible: document.getElementById('settingMarketingVisible').checked,
    showReviewsOnHome: document.getElementById('settingShowReviews').checked,
    maxAge: parseInt(document.getElementById('settingMaxAge').value) || 60,
    ageCalculation: document.getElementById('settingAgeCalc').value
  };
  
  saveData(STORAGE_KEYS.settings, settings);
  alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âœ…');
}

// ==================== Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØªØ£Ø¬ÙŠØ±ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª ====================
function renderCarLeasingPage() {
  const cars = loadData(STORAGE_KEYS.cars, getDefaultCars());
  
  let html = `
    <div style="margin-bottom:16px;">
      <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø±ÙƒØ© Ø³ÙŠØ§Ø±Ø©</h4>
      <input type="text" id="carBrand" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø±ÙƒØ©">
      <input type="text" id="carModels" placeholder="Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)">
      <button class="primary small" onclick="addCarBrand()" style="margin-top:10px;">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    
    <h4>Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„Ù…Ø§Ø±ÙƒØ©</th><th>Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  cars.forEach((car, i) => {
    html += `
      <tr>
        <td>${escapeHtml(car.brand)}</td>
        <td style="font-size:11px;">${car.models?.join(', ') || '-'}</td>
        <td><button class="secondary small" onclick="deleteCarBrand(${i})">Ø­Ø°Ù</button></td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ£Ø¬ÙŠØ±ÙŠ
  html += `
    <hr style="margin:20px 0;">
    <h4>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ£Ø¬ÙŠØ±ÙŠ</h4>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
      <div>
        <label>Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (%):</label>
        <input type="number" id="carDownPayment" value="10" placeholder="10">
      </div>
      <div>
        <label>Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© (%):</label>
        <input type="number" id="carBalloon" value="30" placeholder="30">
      </div>
      <div>
        <label>Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø´Ø§Ù…Ù„:</label>
        <select id="carInsurance">
          <option value="included">Ù…Ø´Ù…ÙˆÙ„</option>
          <option value="separate">Ù…Ù†ÙØµÙ„</option>
        </select>
      </div>
    </div>
  `;
  
  document.getElementById('carLeasingContent').innerHTML = html;
}

function addCarBrand() {
  const brand = document.getElementById('carBrand').value.trim();
  const modelsStr = document.getElementById('carModels').value.trim();
  
  if (!brand) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø±ÙƒØ©');
    return;
  }
  
  const models = modelsStr.split(',').map(m => m.trim()).filter(m => m);
  
  const cars = loadData(STORAGE_KEYS.cars, getDefaultCars());
  cars.push({ id: Date.now(), brand, models });
  saveData(STORAGE_KEYS.cars, cars);
  
  document.getElementById('carBrand').value = '';
  document.getElementById('carModels').value = '';
  renderCarLeasingPage();
}

function deleteCarBrand(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const cars = loadData(STORAGE_KEYS.cars, getDefaultCars());
  cars.splice(index, 1);
  saveData(STORAGE_KEYS.cars, cars);
  renderCarLeasingPage();
}

// ==================== Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ© ====================
function renderDocsPage() {
  const docs = loadData(STORAGE_KEYS.docs, []);
  
  let html = `
    <div style="margin-bottom:16px;">
      <input type="text" id="docTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©">
      <textarea id="docContent" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©" style="height:100px;"></textarea>
      <button class="primary small" onclick="saveDoc()" style="margin-top:10px;">Ø­ÙØ¸</button>
    </div>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
      <tbody>
  `;
  
  docs.forEach((doc, i) => {
    html += `
      <tr>
        <td>${escapeHtml(doc.title)}</td>
        <td>
          <button class="secondary small" onclick="viewDoc(${i})">Ø¹Ø±Ø¶</button>
          <button class="secondary small" onclick="deleteDoc(${i})">Ø­Ø°Ù</button>
        </td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('docsContent').innerHTML = html;
}

function saveDoc() {
  const title = document.getElementById('docTitle').value.trim();
  const content = document.getElementById('docContent').value.trim();
  
  if (!title || !content) {
    alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰');
    return;
  }
  
  const docs = loadData(STORAGE_KEYS.docs, []);
  docs.push({ id: Date.now(), title, content });
  saveData(STORAGE_KEYS.docs, docs);
  
  document.getElementById('docTitle').value = '';
  document.getElementById('docContent').value = '';
  renderDocsPage();
}

function viewDoc(index) {
  const docs = loadData(STORAGE_KEYS.docs, []);
  const doc = docs[index];
  if (doc) {
    alert(doc.title + '\n\n' + doc.content);
  }
}

function deleteDoc(index) {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) return;
  const docs = loadData(STORAGE_KEYS.docs, []);
  docs.splice(index, 1);
  saveData(STORAGE_KEYS.docs, docs);
  renderDocsPage();
}

// ==================== Ø³Ø¬Ù„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ====================
function renderLoginLogsPage() {
  const logs = loadData(STORAGE_KEYS.loginLogs, []);
  
  let html = `
    <button class="secondary small" onclick="clearLoginLogs()" style="margin-bottom:16px;">Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
    <table class="admin-table">
      <thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„Ø¬Ù‡Ø§Ø²</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th></tr></thead>
      <tbody>
  `;
  
  logs.forEach(log => {
    const status = log.success ? 'âœ… Ù†Ø¬Ø§Ø­' : 'âŒ ÙØ´Ù„';
    const device = log.platform || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
    const location = log.location 
      ? `${log.location.lat.toFixed(4)}, ${log.location.lng.toFixed(4)}`
      : 'ØºÙŠØ± Ù…ØªØ§Ø­';
    
    html += `
      <tr style="${!log.success ? 'background:#fef2f2;' : ''}">
        <td>${log.date}</td>
        <td>${status}</td>
        <td style="font-size:10px;">${escapeHtml(device)}</td>
        <td style="font-size:11px;">${location}</td>
      </tr>
    `;
  });
  
  html += `</tbody></table>`;
  document.getElementById('loginLogsContent').innerHTML = html;
}

function clearLoginLogs() {
  if (!confirm('Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ØŸ')) return;
  saveData(STORAGE_KEYS.loginLogs, []);
  renderLoginLogsPage();
}

// ==================== Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ© ====================
function togglePlatformLock() {
  const isLocked = loadData(STORAGE_KEYS.platformLock, false);
  saveData(STORAGE_KEYS.platformLock, !isLocked);
  updateLockButton();
  alert(isLocked ? 'ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ù†ØµØ© âœ…' : 'ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ© ğŸ”’');
}

function updateLockButton() {
  const isLocked = loadData(STORAGE_KEYS.platformLock, false);
  const btn = document.getElementById('lockBtn');
  if (btn) {
    btn.textContent = isLocked ? 'ğŸ”“ ÙØªØ­ Ø§Ù„Ù…Ù†ØµØ©' : 'ğŸ”’ Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©';
  }
}

</script>

<script>
// ==================== ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª ====================
function updateDateTime() {
  const el = document.getElementById('dateTimeDisplay');
  if (!el) return;
  
  const hijri = getHijriDate();
  const gregorian = getGregorianDate();
  const time = new Date().toLocaleTimeString('ar-SA');
  
  el.innerHTML = `${hijri} | ${time}`;
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ====================
function renderHomeReviews() {
  const settings = loadData(STORAGE_KEYS.settings, getDefaultSettings());
  const reviewsSection = document.getElementById('reviewsSection');
  const reviewsList = document.getElementById('reviewsList');
  
  if (!settings.showReviewsOnHome) {
    reviewsSection.style.display = 'none';
    return;
  }
  
  const reviews = loadData(STORAGE_KEYS.reviews, []).filter(r => r.published);
  
  if (reviews.length === 0) {
    reviewsSection.style.display = 'none';
    return;
  }
  
  reviewsSection.style.display = 'block';
  
  let html = '';
  reviews.slice(0, 3).forEach(r => {
    const stars = 'â˜…'.repeat(r.rating) + 'â˜†'.repeat(5 - r.rating);
    html += `
      <div style="background:#f8fafc; border-radius:12px; padding:12px; margin:8px 0; text-align:right;">
        <div style="color:#fbbf24; font-size:16px;">${stars}</div>
        <div style="font-size:13px; color:#374151; margin-top:4px;">"${escapeHtml(r.text || 'ØªØ¬Ø±Ø¨Ø© Ù…Ù…ØªØ§Ø²Ø©!')}"</div>
        <div style="font-size:11px; color:#6b7280; margin-top:4px;">- ${escapeHtml(r.clientName)}</div>
      </div>
    `;
  });
  
  reviewsList.innerHTML = html;
}

// ==================== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ====================
document.addEventListener('DOMContentLoaded', () => {
  // ÙØ­Øµ Ù‚ÙÙ„ Ø§Ù„Ù…Ù†ØµØ©
  const isLocked = loadData(STORAGE_KEYS.platformLock, false);
  if (isLocked) {
    document.body.innerHTML = `
      <div style="display:flex; align-items:center; justify-content:center; min-height:100vh; text-align:center; padding:20px;">
        <div style="background:#fff; border-radius:24px; padding:40px; max-width:400px;">
          <div style="font-size:64px; margin-bottom:16px;">ğŸ”’</div>
          <h2 style="margin:0 0 12px; color:#111827;">Ø§Ù„Ù…Ù†ØµØ© Ù…Ù‚ÙÙ„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h2>
          <p style="color:#6b7280; font-size:14px;">ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù„ÙØªØ­ Ø§Ù„Ù…Ù†ØµØ©.</p>
          <div class="admin-icon-hidden" onclick="showAdminLogin()" style="position:fixed; bottom:10px; left:10px;">â–«ï¸</div>
        </div>
      </div>
    `;
    return;
  }
  
  // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
  if (!localStorage.getItem(STORAGE_KEYS.banks)) {
    saveData(STORAGE_KEYS.banks, getDefaultBanks());
  }
  if (!localStorage.getItem(STORAGE_KEYS.jobs)) {
    saveData(STORAGE_KEYS.jobs, getDefaultJobs());
  }
  if (!localStorage.getItem(STORAGE_KEYS.products)) {
    saveData(STORAGE_KEYS.products, getDefaultProducts());
  }
  if (!localStorage.getItem(STORAGE_KEYS.cars)) {
    saveData(STORAGE_KEYS.cars, getDefaultCars());
  }
  if (!localStorage.getItem(STORAGE_KEYS.settings)) {
    saveData(STORAGE_KEYS.settings, getDefaultSettings());
  }
  
  // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  showPage('landing');
  
  // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
  renderHomeReviews();
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ®
  updateDateTime();
  setInterval(updateDateTime, 1000);
});
</script>

</body>
</html>